<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Kuantara â€“ Latest 24/7 & Catalyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Fira Code -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&display=swap"/>

  <style>
    :root {
      --bg-root:#000000;
      --bg-main:#111111;
      --border-soft:#2b2b2b;
      --text-main:#f5f5f5;
      --text-muted:#9b9b9b;
      --accent:#ffbf00;

      --fs-title:14px;
      --fs-subtitle:12px;
      --fs-body:11px;
      --fs-small:9.5px;

      --green:#22c55e;
      --red:#ef4444;
    }

    * {
      box-sizing:border-box;
      margin:0;
      padding:0;
      font-family:"Fira Code",monospace !important;
    }

    html,body {
      height:100%;
    }

    body {
      background:var(--bg-root);
      color:var(--text-main);
      overflow:hidden;
    }

    /* SCROLLBARS â€“ HITAM TRANSPARAN */
    * {
      scrollbar-width:thin;
      scrollbar-color:#00000088 #000000;
    }
    *::-webkit-scrollbar {
      width:6px;
      height:6px;
    }
    *::-webkit-scrollbar-track {
      background:#000000;
    }
    *::-webkit-scrollbar-thumb {
      background:#00000088;
      border-radius:3px;
    }

    .kt-shell {
      padding:16px;
      height:100vh;
      display:flex;
      flex-direction:column;
      gap:12px;
      background:var(--bg-root);
    }

    .kt-title {
      font-size:var(--fs-title);
      letter-spacing:0.16em;
      text-transform:uppercase;
      color:var(--text-main);
    }

    .kt-sub {
      font-size:var(--fs-small);
      color:var(--text-muted);
      margin-top:4px;
    }

    .kt-card {
      background:var(--bg-main);
      border:1px solid var(--border-soft);
      border-radius:4px;
      padding:14px 16px;
    }

    .kt-row {
      display:flex;
      flex-direction:row;
      align-items:flex-start;
      gap:12px;
      height:calc(100vh - 56px);
    }

    .kt-col {
      flex:1;
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    @media (max-width:768px) {
      body {
        overflow:auto;
      }
      .kt-row {
        flex-direction:column;
        height:auto;
      }
    }

    /* HEADER BAR DI CARD */
    .card-header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      margin-bottom:10px;
    }

    .card-header-left {
      display:flex;
      flex-direction:column;
      gap:2px;
    }

    .card-label {
      font-size:var(--fs-subtitle);
      text-transform:uppercase;
      letter-spacing:0.18em;
      color:var(--accent);
    }

    .card-meta {
      font-size:var(--fs-small);
      color:var(--text-muted);
    }

    .card-header-right {
      font-size:var(--fs-small);
      color:var(--text-muted);
      display:flex;
      align-items:center;
      gap:6px;
      white-space:nowrap;
    }

    .dot-live {
      width:7px;
      height:7px;
      border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 12px var(--accent);
      animation:pulse 1.4s ease-out infinite;
    }

    @keyframes pulse {
      0% { transform:scale(1); opacity:1; }
      60% { transform:scale(1.8); opacity:0; }
      100% { transform:scale(1.8); opacity:0; }
    }

    /* TABS: LATEST VS CATALYST */
    .tab-bar {
      display:flex;
      align-items:center;
      gap:6px;
      margin-bottom:10px;
      flex-wrap:wrap;
    }

    .tab-btn {
      border-radius:999px;
      padding:4px 10px;
      font-size:var(--fs-small);
      text-transform:uppercase;
      letter-spacing:0.14em;
      border:1px solid var(--border-soft);
      background:#000;
      color:var(--text-muted);
      cursor:pointer;
      transition:background .15s ease, color .15s ease, border-color .15s ease;
    }

    .tab-btn.active {
      background:var(--accent);
      color:#000;
      border-color:var(--accent);
    }

    .tab-btn:disabled {
      opacity:.5;
      cursor:default;
    }

    /* PANEL WRAPPER */
    .panel {
      display:none;
      flex:1;
      min-height:0;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .panel.active {
      display:flex;
    }

    /* FILTER BAR */
    .filter-row {
      display:flex;
      flex-direction:row;
      gap:8px;
      align-items:flex-start;
      flex-wrap:wrap;
    }

    .filter-group {
      flex:1 1 220px;
      min-width:0;
    }

    .filter-label {
      font-size:var(--fs-small);
      color:var(--text-muted);
      margin-bottom:3px;
    }

    select.category-select {
      width:100%;
      background:#000;
      color:var(--text-main);
      border:1px solid var(--border-soft);
      padding:5px 8px;
      font-size:var(--fs-small);
      text-transform:uppercase;
      letter-spacing:0.12em;
    }

    .btn-recap {
      flex:0 0 auto;
      white-space:nowrap;
      border-radius:3px;
      border:1px solid var(--accent);
      background:#000;
      color:var(--accent);
      padding:6px 10px;
      font-size:var(--fs-small);
      text-transform:uppercase;
      letter-spacing:0.12em;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }

    .btn-recap span.icon {
      font-size:11px;
    }

    .btn-recap:disabled {
      opacity:.5;
      cursor:default;
    }

    /* STATUS BAR */
    .status-row {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      font-size:var(--fs-small);
      color:var(--text-muted);
      margin-top:4px;
    }

    .status-left {
      display:flex;
      align-items:center;
      gap:6px;
    }

    .status-dot {
      width:6px;
      height:6px;
      border-radius:999px;
      background:#555;
    }

    /* LIST */
    .feed-container {
      margin-top:8px;
      border-radius:4px;
      border:1px solid var(--border-soft);
      background:#080808;
      padding:8px;
      flex:1;
      min-height:0;
      overflow:auto;
    }

    .feed-list {
      list-style:none;
      margin:0;
      padding:0;
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .feed-card {
      border:1px solid var(--border-soft);
      border-radius:3px;
      padding:8px 9px;
      background:#111111;
      display:flex;
      flex-direction:column;
      gap:4px;
      font-size:var(--fs-body);
    }

    .feed-card.important {
      border-color:var(--accent);
      box-shadow:0 0 18px rgba(255,191,0,0.18);
    }

    .feed-header-row {
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:8px;
    }

    .feed-headline-wrap {
      display:flex;
      align-items:flex-start;
      gap:6px;
      flex:1;
      min-width:0;
    }

    .head-dot {
      width:6px;
      height:6px;
      border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 10px rgba(255,191,0,0.6);
      margin-top:3px;
      flex-shrink:0;
    }

    .headline {
      font-size:var(--fs-body);
      color:var(--text-main);
    }

    .headline span.source {
      color:var(--text-muted);
      font-size:var(--fs-small);
    }

    .copy-btn {
      border:none;
      outline:none;
      cursor:pointer;
      padding:4px 6px;
      border-radius:3px;
      font-size:var(--fs-small);
      background:#000000;
      color:var(--text-muted);
      border:1px solid var(--border-soft);
      flex-shrink:0;
    }

    .copy-btn.copied {
      background:var(--accent);
      color:#000;
      border-color:var(--accent);
    }

    .feed-meta {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:6px;
      font-size:var(--fs-small);
      color:var(--text-muted);
    }

    .feed-time {
      font-size:var(--fs-small);
      color:var(--text-muted);
    }

    .feed-tags {
      display:flex;
      flex-wrap:wrap;
      gap:4px;
      margin-top:2px;
    }

    .chip {
      border-radius:999px;
      padding:2px 6px;
      border:1px solid var(--border-soft);
      font-size:var(--fs-small);
      color:var(--text-muted);
      background:#000000;
    }

    .chip-high {
      border-color:var(--accent);
      color:var(--accent);
    }

    .impact-badge {
      font-size:var(--fs-small);
      padding:2px 6px;
      border-radius:999px;
      border:1px solid var(--border-soft);
      background:#000;
      color:var(--text-muted);
    }

    .impact-high {
      border-color:var(--accent);
      color:var(--accent);
    }

    .impact-medium {
      border-color:#f97316;
      color:#f97316;
    }

    .feed-body {
      font-size:var(--fs-body);
      color:var(--text-main);
      margin-top:2px;
    }

    /* SHIMMER / SKELETON */
    .shimmer-line {
      position:relative;
      overflow:hidden;
      background:#1b1b1b;
      border-radius:3px;
    }

    .shimmer-line::after {
      content:"";
      position:absolute;
      inset:0;
      transform:translateX(-100%);
      background-image:linear-gradient(
        90deg,
        transparent,
        rgba(255,255,255,0.10),
        transparent
      );
      animation:shimmer 1.3s infinite;
    }

    @keyframes shimmer {
      0% { transform:translateX(-100%); }
      100% { transform:translateX(100%); }
    }

    .skeleton-title {
      height:11px;
      width:72%;
      margin-bottom:4px;
    }

    .skeleton-sub {
      height:9px;
      width:40%;
    }

    .skeleton-body {
      height:9px;
      width:100%;
      margin-top:2px;
    }

    .skeleton-tags {
      margin-top:4px;
      display:flex;
      gap:4px;
    }

    .skeleton-tag {
      height:9px;
      width:50px;
    }

    /* SMALL MODAL UNTUK RECAP (STUB â€“ SIAP DIHUBUNGKAN KE AI) */
    .modal-overlay {
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.78);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:40;
    }

    .modal-overlay.active {
      display:flex;
    }

    .modal-card {
      background:#111;
      border:1px solid var(--border-soft);
      border-radius:4px;
      padding:14px 16px;
      width:min(640px,100% - 32px);
      max-height:80vh;
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .modal-header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      margin-bottom:4px;
    }

    .modal-title {
      font-size:var(--fs-subtitle);
      text-transform:uppercase;
      letter-spacing:0.16em;
      color:var(--accent);
    }

    .modal-close {
      border:none;
      background:#000;
      color:var(--text-muted);
      border-radius:3px;
      padding:3px 7px;
      font-size:var(--fs-small);
      cursor:pointer;
    }

    .modal-body {
      font-size:var(--fs-body);
      color:var(--text-main);
      overflow:auto;
      padding-top:4px;
    }

    .modal-body p + p {
      margin-top:4px;
    }

    .modal-status {
      font-size:var(--fs-small);
      color:var(--text-muted);
    }
  </style>
</head>
<body>
  <div class="kt-shell">
    <header>
      <div class="kt-title">Latest 24/7 & Catalyst</div>
      <div class="kt-sub">Realtime headline feed & catalyst monitor Â· Siap dihubungkan WebSocket/API Kuantara</div>
    </header>

    <main class="kt-row">
      <section class="kt-col">
        <article class="kt-card" id="latestCatalystCard">
          <div class="card-header">
            <div class="card-header-left">
              <div class="card-label">Global Macro Newswire</div>
              <div class="card-meta">FastBull Â· PriapusIQ Â· Kuantara AI (stub feed Â· hubungkan backend Anda)</div>
            </div>
            <div class="card-header-right">
              <div class="dot-live"></div>
              <span id="globalStatusText">Live 24/7 feed Â· demo</span>
            </div>
          </div>

          <!-- Tabs -->
          <div class="tab-bar" id="tabBar">
            <button class="tab-btn active" data-target="latestPanel">Latest 24/7</button>
            <button class="tab-btn" data-target="catalystPanel">Catalyst</button>
          </div>

          <!-- LATEST 24/7 PANEL -->
          <div class="panel active" id="latestPanel">
            <div class="filter-row">
              <div class="filter-group">
                <div class="filter-label">Filter kategori</div>
                <select id="latestCategoryDropdown" class="category-select">
                  <option value="-1">Semua</option>
                  <option value="central_banks">Central Banks</option>
                  <option value="crypto">Cryptocurrencies</option>
                  <option value="equities">Stocks</option>
                  <option value="macro">Macroeconomics</option>
                  <option value="topics">Topics</option>
                </select>
              </div>
              <button id="latestRecapBtn" class="btn-recap">
                <span class="icon">âš¡</span>
                <span>Recap Semua Catalyst by Kuantara AI</span>
              </button>
            </div>

            <div class="status-row">
              <div class="status-left">
                <div class="status-dot"></div>
                <span>HEADLINE 24/7</span>
              </div>
              <div id="latestStatus">Waiting feedâ€¦</div>
            </div>

            <div class="feed-container">
              <ul id="latestTicker" class="feed-list">
                <!-- diisi JS -->
              </ul>
            </div>
          </div>

          <!-- CATALYST PANEL -->
          <div class="panel" id="catalystPanel">
            <div class="filter-row">
              <div class="filter-group">
                <div class="filter-label">Filter kategori catalyst</div>
                <select id="catalystCategoryDropdown" class="category-select">
                  <option value="all">Semua</option>
                  <option value="policy">Policy / Central Bank</option>
                  <option value="data">Data Ekonomi</option>
                  <option value="risk">Risk Event & Geopolitik</option>
                  <option value="micro">Micro / Earnings</option>
                </select>
              </div>
              <button id="catalystRecapBtn" class="btn-recap">
                <span class="icon">ðŸ§ </span>
                <span>Recap Catalyst Terpilih</span>
              </button>
            </div>

            <div class="status-row">
              <div class="status-left">
                <div class="status-dot"></div>
                <span>Catalyst Feed</span>
              </div>
              <div id="catalystStatus">Waiting feedâ€¦</div>
            </div>

            <div class="feed-container">
              <ul id="catalystList" class="feed-list">
                <!-- diisi JS -->
              </ul>
            </div>
          </div>
        </article>
      </section>
    </main>
  </div>

  <!-- Modal Kuantara AI Recap -->
  <div id="kuantaraModal" class="modal-overlay">
    <div class="modal-card">
      <div class="modal-header">
        <div class="modal-title" id="kuantaraTitle">Kuantara AI Recap</div>
        <button class="modal-close" id="kuantaraClose">CLOSE</button>
      </div>
      <div class="modal-status" id="kuantaraStatus">Menyiapkan ringkasanâ€¦</div>
      <div class="modal-body" id="kuantaraBody">
        <p>Stub recap untuk demo. Hubungkan ke backend AI (OpenAI / HF / internal) untuk menghasilkan insight otomatis.</p>
      </div>
    </div>
  </div>

  <script>
    // ====== DUMMY DATA (GANTI DENGAN FEED WEBSOCKET/API ANDA) ======
    const demoLatest = [
      {
        id: "1",
        title: "FED officials signal patience as inflation cools but remains above target",
        source: "FastBull",
        time: "Just now",
        tags: ["FED", "Rates", "USD"],
        important: true,
      },
      {
        id: "2",
        title: "Oil slides on weak demand outlook as global growth concerns resurface",
        source: "PriapusIQ",
        time: "5m ago",
        tags: ["Crude Oil", "Growth", "Risk-Off"],
        important: false,
      },
      {
        id: "3",
        title: "Bitcoin stabilises after sharp flush while tech equities extend losses",
        source: "Mixed",
        time: "12m ago",
        tags: ["BTC", "Nasdaq", "Risk Sentiment"],
        important: false,
      },
    ];

    const demoCatalyst = [
      {
        id: "c1",
        title: "US CPI (Core) miss on downside â€” market reprice 2 extra cuts next 12M",
        impact: "High",
        category: "data",
        time: "Today 20:30 JKT",
        body: "Core CPI m/m dan y/y sama-sama lebih rendah dari konsensus, memicu turun tajam yield US Treasury dan pelemahan USD broad-based.",
        tags: ["US CPI", "Rates Cut", "USD", "UST"],
      },
      {
        id: "c2",
        title: "ECB official hints at slower pace of cuts after recent easing cycle",
        impact: "Medium",
        category: "policy",
        time: "Today 16:10 JKT",
        body: "Komentar hawkish ringan dari beberapa pejabat ECB menahan pelemahan Euro pasca data manufaktur lemah.",
        tags: ["ECB", "EUR", "Policy"],
      },
      {
        id: "c3",
        title: "Middle East tensions escalate with new supply risk to crude shipments",
        impact: "High",
        category: "risk",
        time: "Yesterday",
        body: "Ancaman gangguan jalur pengiriman minyak meningkatkan risk premium pada harga Brent dan WTI.",
        tags: ["Geopolitics", "Crude Oil", "Risk Premium"],
      },
    ];

    // ====== ELEMENTS ======
    const tabBar = document.getElementById("tabBar");
    const latestPanel = document.getElementById("latestPanel");
    const catalystPanel = document.getElementById("catalystPanel");
    const latestListEl = document.getElementById("latestTicker");
    const latestStatusEl = document.getElementById("latestStatus");
    const latestDropdown = document.getElementById("latestCategoryDropdown");
    const latestRecapBtn = document.getElementById("latestRecapBtn");
    const catalystListEl = document.getElementById("catalystList");
    const catalystStatusEl = document.getElementById("catalystStatus");
    const catalystDropdown = document.getElementById("catalystCategoryDropdown");
    const catalystRecapBtn = document.getElementById("catalystRecapBtn");

    const kuantaraModal = document.getElementById("kuantaraModal");
    const kuantaraClose = document.getElementById("kuantaraClose");
    const kuantaraTitle = document.getElementById("kuantaraTitle");
    const kuantaraStatus = document.getElementById("kuantaraStatus");
    const kuantaraBody = document.getElementById("kuantaraBody");

    // ====== UTIL ======
    const COPY_ICON = "Copy";
    const CHECK_ICON = "Copied";

    function clearList(el) {
      if (!el) return;
      while (el.firstChild) el.removeChild(el.firstChild);
    }

    function renderLatestSkeleton(rows = 3) {
      if (!latestListEl) return;
      clearList(latestListEl);
      for (let i = 0; i < rows; i++) {
        const li = document.createElement("li");
        li.className = "feed-card";
        li.innerHTML = `
          <div class="skeleton-title shimmer-line"></div>
          <div class="skeleton-sub shimmer-line"></div>
          <div class="skeleton-body shimmer-line"></div>
          <div class="skeleton-tags">
            <div class="skeleton-tag shimmer-line"></div>
            <div class="skeleton-tag shimmer-line"></div>
          </div>
        `;
        latestListEl.appendChild(li);
      }
    }

    function renderCatalystSkeleton(rows = 3) {
      if (!catalystListEl) return;
      clearList(catalystListEl);
      for (let i = 0; i < rows; i++) {
        const li = document.createElement("li");
        li.className = "feed-card";
        li.innerHTML = `
          <div class="skeleton-title shimmer-line"></div>
          <div class="skeleton-sub shimmer-line"></div>
          <div class="skeleton-body shimmer-line"></div>
        `;
        catalystListEl.appendChild(li);
      }
    }

    function copyHeadline(text, button) {
      if (!text || !button) return;
      const original = button.textContent;
      const markCopied = () => {
        button.classList.add("copied");
        button.textContent = CHECK_ICON;
        setTimeout(() => {
          button.classList.remove("copied");
          button.textContent = original;
        }, 1400);
      };

      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).then(markCopied).catch(() => {
          fallbackCopy();
        });
      } else {
        fallbackCopy();
      }

      function fallbackCopy() {
        const ta = document.createElement("textarea");
        ta.value = text;
        ta.style.position = "fixed";
        ta.style.opacity = "0";
        document.body.appendChild(ta);
        ta.select();
        try {
          document.execCommand("copy");
        } catch (_) {}
        document.body.removeChild(ta);
        markCopied();
      }
    }

    // ====== RENDERERS ======
    function renderLatestFeed(items) {
      if (!latestListEl) return;
      clearList(latestListEl);
      if (!items || !items.length) {
        const li = document.createElement("li");
        li.className = "feed-card";
        li.innerHTML = `<div class="feed-body" style="color:var(--text-muted)">Belum ada headline untuk kategori ini.</div>`;
        latestListEl.appendChild(li);
        return;
      }

      items.forEach(item => {
        const li = document.createElement("li");
        li.className = "feed-card" + (item.important ? " important" : "");
        const safeSource = item.source || "Source";
        const tags = Array.isArray(item.tags) ? item.tags : [];

        const headlineHtml = `
          <div class="feed-header-row">
            <div class="feed-headline-wrap">
              ${item.important ? '<div class="head-dot"></div>' : ""}
              <div>
                <div class="headline">
                  ${item.title}
                  <span class="source"> Â· ${safeSource}</span>
                </div>
              </div>
            </div>
            <button class="copy-btn">${COPY_ICON}</button>
          </div>
        `;

        li.innerHTML = headlineHtml + `
          <div class="feed-meta">
            <span class="feed-time">${item.time || ""}</span>
          </div>
          ${
            tags.length
              ? `<div class="feed-tags">${tags
                  .map(t => `<span class="chip">${t}</span>`)
                  .join("")}</div>`
              : ""
          }
        `;

        const copyButton = li.querySelector(".copy-btn");
        copyButton?.addEventListener("click", () => copyHeadline(item.title, copyButton));
        latestListEl.appendChild(li);
      });
    }

    function renderCatalystFeed(items) {
      if (!catalystListEl) return;
      clearList(catalystListEl);
      if (!items || !items.length) {
        const li = document.createElement("li");
        li.className = "feed-card";
        li.innerHTML = `<div class="feed-body" style="color:var(--text-muted)">Belum ada catalyst yang aktif untuk filter ini.</div>`;
        catalystListEl.appendChild(li);
        return;
      }

      items.forEach(item => {
        const li = document.createElement("li");
        li.className = "feed-card";
        const impact = (item.impact || "").toLowerCase();
        const high = impact.includes("high");
        const medium = impact.includes("medium");

        const impactClass =
          high ? "impact-badge impact-high" : medium ? "impact-badge impact-medium" : "impact-badge";

        li.innerHTML = `
          <div class="feed-header-row">
            <div class="feed-headline-wrap">
              ${high ? '<div class="head-dot"></div>' : ""}
              <div>
                <div class="headline">${item.title}</div>
                <div class="feed-meta">
                  <span class="feed-time">${item.time || ""}</span>
                  <span class="${impactClass}">${item.impact || "Impact"}</span>
                </div>
              </div>
            </div>
          </div>
          <div class="feed-body">${item.body || ""}</div>
          ${
            item.tags && item.tags.length
              ? `<div class="feed-tags">${item.tags
                  .map(t => `<span class="chip">${t}</span>`)
                  .join("")}</div>`
              : ""
          }
        `;
        catalystListEl.appendChild(li);
      });
    }

    // ====== FILTERING (DEMO) ======
    function filterDemoLatestByCategory(value) {
      if (value === "-1") return demoLatest;
      if (value === "central_banks") return demoLatest.filter(d => d.tags.some(t => /fed|ecb|boe|boj/i.test(t)));
      if (value === "crypto") return demoLatest.filter(d => d.tags.some(t => /btc|crypto/i.test(t)));
      if (value === "equities") return demoLatest.filter(d => d.tags.some(t => /Nasdaq|SPX|equity/i.test(t)));
      if (value === "macro") return demoLatest.filter(d => d.tags.some(t => /growth|macro|inflation/i.test(t)));
      if (value === "topics") return demoLatest.slice(0, 1);
      return demoLatest;
    }

    function filterDemoCatalystByCategory(value) {
      if (value === "all") return demoCatalyst;
      return demoCatalyst.filter(d => (d.category || "").toLowerCase() === value.toLowerCase());
    }

    // ====== MODAL / KUANTARA AI STUB ======
    function openRecapModal(context) {
      if (!kuantaraModal) return;
      const { title, description } = context || {};
      kuantaraModal.classList.add("active");
      document.body.style.overflow = "hidden";
      if (kuantaraTitle) kuantaraTitle.textContent = title || "Kuantara AI Recap";
      if (kuantaraStatus) kuantaraStatus.textContent =
        "Ini masih demo. Hubungkan ke backend AI untuk ringkasan otomatis berbasis feed real-time.";
      if (kuantaraBody) {
        kuantaraBody.innerHTML = "";
        const p1 = document.createElement("p");
        p1.textContent = description || "Contoh prompt: 'Ringkas semua catalyst penting, jelaskan implikasi ke USD, saham, dan komoditas.'";
        const p2 = document.createElement("p");
        p2.textContent = "Di production, tombol ini bisa memanggil endpoint AI (misalnya /api/ai/recap) dengan payload headline/catalyst terbaru.";
        kuantaraBody.appendChild(p1);
        kuantaraBody.appendChild(p2);
      }
    }

    function closeRecapModal() {
      if (!kuantaraModal) return;
      kuantaraModal.classList.remove("active");
      document.body.style.overflow = "";
    }

    // ====== INIT ======
    function initTabs() {
      if (!tabBar) return;
      const buttons = Array.from(tabBar.querySelectorAll(".tab-btn"));
      buttons.forEach(btn => {
        btn.addEventListener("click", () => {
          const target = btn.getAttribute("data-target");
          buttons.forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          [latestPanel, catalystPanel].forEach(p => {
            if (!p) return;
            if (p.id === target) p.classList.add("active");
            else p.classList.remove("active");
          });
        });
      });
    }

    function initLatestPanel() {
      if (!latestListEl) return;
      renderLatestSkeleton(3);
      setTimeout(() => {
        latestStatusEl.textContent = "Demo data Â· ganti dengan feed FastBull/CityFalcon/WebSocket";
        renderLatestFeed(demoLatest);
      }, 500);

      latestDropdown?.addEventListener("change", () => {
        const v = latestDropdown.value || "-1";
        const filtered = filterDemoLatestByCategory(v);
        latestStatusEl.textContent = "Filtered Â· demo only";
        renderLatestFeed(filtered);
      });

      latestRecapBtn?.addEventListener("click", () => {
        openRecapModal({
          title: "Kuantara AI â€“ Latest 24/7 Recap",
          description: "Gunakan headline 24/7 di panel ini untuk membuat narasi makro harian dan bias cross-asset.",
        });
      });
    }

    function initCatalystPanel() {
      if (!catalystListEl) return;
      renderCatalystSkeleton(3);
      setTimeout(() => {
        catalystStatusEl.textContent = "Demo data Â· ganti dengan Google Script / PriapusIQ / internal API";
        renderCatalystFeed(demoCatalyst);
      }, 600);

      catalystDropdown?.addEventListener("change", () => {
        const v = catalystDropdown.value || "all";
        const filtered = filterDemoCatalystByCategory(v);
        catalystStatusEl.textContent = "Filtered Â· demo only";
        renderCatalystFeed(filtered);
      });

      catalystRecapBtn?.addEventListener("click", () => {
        openRecapModal({
          title: "Kuantara AI â€“ Catalyst Recap",
          description: "Gabungkan catalyst terfilter untuk menyusun skenario base, bull, dan bear market.",
        });
      });
    }

    function initModal() {
      kuantaraClose?.addEventListener("click", closeRecapModal);
      kuantaraModal?.addEventListener("click", (e) => {
        if (e.target === kuantaraModal) closeRecapModal();
      });
    }

    function initPage() {
      initTabs();
      initLatestPanel();
      initCatalystPanel();
      initModal();
    }

    window.addEventListener("load", initPage);
  </script>
</body>
</html>
