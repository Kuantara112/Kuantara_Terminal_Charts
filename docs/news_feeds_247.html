<html lang="en"><head>
  <meta charset="UTF-8">
  <title>Kuantara Terminal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Fira Code -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&amp;display=swap">

  <style>
    :root {
      --amber:#ffbf00; --bg-root:#000; --bg-main:#111; --border-soft:#2b2b2b;
      --text-main:#f5f5f5; --text-muted:#9b9b9b; --overlay:rgba(0,0,0,0.6);
    }

    /* GLOBAL RESET + SCROLLBAR HITAM */
    *{
      box-sizing:border-box;
      margin:0;
      padding:0;
      font-family:"Fira Code",monospace!important;
      /* Firefox scrollbar */
      scrollbar-width:thin;
      scrollbar-color:#000000 #000000; /* thumb | track */
    }

    /* WebKit scrollbar (Chrome, Edge, Safari) */
    ::-webkit-scrollbar{
      width:6px;
      height:6px;
    }
    ::-webkit-scrollbar-track{
      background:#000000; /* track hitam */
    }
    ::-webkit-scrollbar-thumb{
      background:#000000; /* thumb hitam */
      border-radius:4px;
    }
    ::-webkit-scrollbar-thumb:hover{
      background:#050505; /* sedikit lebih terang saat hover */
    }

    html,body{height:100%}

    /* Scroll behavior */
    body{
      background-color:var(--bg-root);
      color:var(--text-main);
      overflow:hidden;
    }
    @media (max-width: 768px){
      body{
        overflow:auto;
        -webkit-overflow-scrolling:touch;
      }
    }

    .kt-root{display:flex;flex-direction:column;height:100vh;position:relative}

    /* ===== IFRAME LAYER (RESPECT HEADER + BOTTOM NAV) ===== */
    .kt-iframe-layer{
      position:fixed;
      left:0;
      right:0;
      top:38px;
      bottom:46px;
      z-index:1;
      background:#0b0b0b;
    }
    .kt-iframe-layer iframe{
      width:100%;
      height:100%;
      border:0;
      display:block;
      background:#0b0b0b;
      touch-action:auto;
    }

    /* ===== TOPMOST BAR (NO AUTOHIDE) ===== */
    .kt-topbar{
      position:fixed;top:0;left:0;right:0;display:flex;align-items:center;justify-content:center;
      background:#070707;
      border-bottom:1px solid var(--border-soft);
      padding:8px 12px;font-size:10px;z-index:3000;
    }
    .kt-topbar-left{display:flex;align-items:center;justify-content:center;gap:8px;min-width:0;flex-wrap:wrap}
    .kt-logo{font-weight:700;letter-spacing:.06em;text-transform:uppercase;font-size:14px;color:var(--amber);white-space:nowrap}
    .kt-session-clock{display:flex;flex-wrap:wrap;gap:4px;align-items:center;font-size:9px;color:var(--text-muted)}
    .kt-session-item{display:inline-flex;gap:2px;align-items:baseline;white-space:nowrap;padding:1px 4px;border-radius:2px;background:#101010;border:1px solid #151515}
    .kt-session-label{color:var(--amber);font-size:9px}.kt-session-time{font-size:9px}

    /* ===== UI CHROME (AUTOHIDE) ===== */
    .kt-main{flex:1;display:flex;flex-direction:column;background:transparent;min-height:0;position:relative;z-index:5}

    .kt-mainmenu-strip,
    .kt-content-header,
    .kt-statusbar,
    .kt-submenu-strip{
      transition:transform 220ms ease,opacity 180ms ease;
      will-change:transform,opacity;
      pointer-events:auto;
      z-index:2800;
      position:fixed;
    }

    /* MAIN MENU (TOP) */
    .kt-mainmenu-strip{
      top:38px;
      left:0;
      right:0;
      display:flex;
      gap:4px;
      padding:6px 8px;
      background:#050505cf;
      border-bottom:1px solid var(--border-soft);
      overflow-x:auto;
      scrollbar-width:thin;
      backdrop-filter:blur(4px);
      justify-content:center;
    }
    .kt-hide-top{transform:translateY(-100%);opacity:.02;pointer-events:none}

    .kt-mainmenu-btn{
      flex:0 0 auto;padding:4px 8px;border-radius:3px;border:1px solid var(--border-soft);
      background:#101010;color:var(--text-muted);font-size:11px;display:inline-flex;align-items:center;gap:4px;
      cursor:pointer;white-space:nowrap;touch-action:manipulation
    }
    .kt-mainmenu-btn span:first-child{color:var(--amber);font-weight:500}
    .kt-mainmenu-btn.active{background:var(--amber);color:#000;border-color:#f0f0f0}
    .kt-mainmenu-btn.active span:first-child{color:#000}

    /* CONTENT HEADER */
    .kt-content-header{
      top:78px;left:0;right:0;border-bottom:1px solid var(--border-soft);padding:6px 10px;display:flex;
      justify-content:space-between;align-items:center;font-size:11px;gap:8px;flex-wrap:wrap;background:#0a0a0acc;backdrop-filter:blur(4px)
    }
    .kt-breadcrumb{display:flex;gap:6px;align-items:baseline;min-width:0}
    .kt-breadcrumb-main{color:var(--amber);font-weight:500;white-space:nowrap}
    .kt-breadcrumb-sub{color:var(--text-muted);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:160px}

    /* STATUS BAR */
    .kt-statusbar{
      left:0;right:0;bottom:46px;border-top:1px solid var(--border-soft);padding:4px 10px 6px;font-size:10px;display:flex;align-items:center;
      background:#050505cc;color:var(--text-muted);backdrop-filter:blur(4px)
    }
    .kt-hide-bottom{transform:translateY(100%);opacity:.02;pointer-events:none}
    .kt-status-msg{font-size:10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}

    /* SUB MENU (BOTTOM STRIP) */
    .kt-submenu-strip{
      left:0;right:0;bottom:46px;border-top:1px solid var(--border-soft);background:#090909cc;padding:4px 6px 4px 8px;min-height:32px;backdrop-filter:blur(4px)
    }
    .kt-submenu-group{display:none;gap:4px;overflow-x:auto;padding-bottom:2px}
    .kt-submenu-group.active{display:flex}
    .kt-submenu-btn{
      flex:0 0 auto;padding:3px 8px;border-radius:3px;border:1px solid var(--border-soft);background:#101010;color:var(--text-muted);
      font-size:10px;cursor:pointer;white-space:nowrap;touch-action:manipulation
    }
    .kt-submenu-btn.active{background:var(--amber);color:#000;border-color:#f0f0f0}

    /* BOTTOM NAV (3 MENU: HOME / 24/7 / PROFILE) */
    .kt-bottom-nav{
      position:fixed;
      left:0;right:0;bottom:0;height:46px;background:#050505e6;border-top:1px solid var(--border-soft);
      display:flex;justify-content:space-around;align-items:stretch;font-size:10px;backdrop-filter:blur(4px);
      z-index:2800;
    }
    .kt-bottom-item{
      flex:1;
      display:flex;flex-direction:column;
      align-items:center;justify-content:center;
      color:var(--text-muted);
      cursor:pointer;gap:2px;
      touch-action:manipulation;
      font-size:11px;
    }
    .kt-bottom-item.active{
      background:#151515;
      color:var(--amber);
    }

    /* PROFILE PAGE (PAGE BARU) */
    .kt-profile-page{
      position:fixed;
      left:0;
      right:0;
      top:0;
      bottom:46px;
      padding:64px 16px 16px;
      z-index:2;
      display:none;
      overflow:auto;
      background:radial-gradient(circle at top left,#1a1200,#050505 55%);
    }
    .kt-profile-inner{
      max-width:720px;
      margin:0 auto;
      background:#0e0e0e;
      border-radius:12px;
      border:1px solid var(--border-soft);
      padding:16px 18px;
      box-shadow:0 10px 30px rgba(0,0,0,.7);
      font-size:11px;
      color:var(--text-muted);
    }
    .kt-profile-header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:12px;
      margin-bottom:12px;
    }
    .kt-profile-title{
      font-size:12px;
      color:var(--amber);
      font-weight:600;
    }
    .kt-profile-name{
      font-size:13px;
      color:var(--text-main);
      font-weight:600;
    }
    .kt-profile-meta{
      font-size:10px;
      color:var(--text-muted);
    }
    .kt-badge{
      display:inline-flex;
      align-items:center;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid var(--border-soft);
      background:#151515;
      font-size:10px;
      color:var(--amber);
      gap:4px;
    }
    .kt-profile-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
      gap:10px;
      margin-top:8px;
    }
    .kt-profile-card{
      border-radius:8px;
      border:1px solid var(--border-soft);
      background:#101010;
      padding:8px 10px;
    }
    .kt-profile-card-title{
      font-size:10px;
      color:var(--amber);
      margin-bottom:4px;
    }
    .kt-profile-card-body{
      font-size:10px;
      line-height:1.5;
    }

    .kt-profile-menu{
      margin-top:14px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .kt-profile-menu-btn{
      padding:6px 12px;
      border-radius:999px;
      border:1px solid var(--border-soft);
      background:#111;
      color:var(--text-main);
      font-size:10px;
      cursor:pointer;
    }
    .kt-profile-menu-btn:hover{
      background:#181818;
    }
    .kt-profile-footer{
      margin-top:14px;
      padding-top:8px;
      border-top:1px solid var(--border-soft);
      font-size:9px;
      color:var(--text-muted);
      line-height:1.4;
    }

    /* FLOATING FAB + MENU + PANEL */
    .kt-ai-fab{
      position:fixed;right:16px;bottom:90px;width:48px;height:48px;border-radius:50%;
      background:var(--amber);color:#000;display:flex;align-items:center;justify-content:center;
      font-size:15px;font-weight:700;box-shadow:0 6px 14px rgba(0,0,0,.6);cursor:pointer;z-index:3000;border:1px solid #f0f0f0;user-select:none
    }

    .kt-ai-menu{
      position:fixed;right:16px;bottom:150px;display:none;flex-direction:column;gap:6px;
      z-index:3000;
    }
    .kt-ai-menu-btn{
      padding:6px 10px;border-radius:999px;border:1px solid var(--border-soft);
      background:#111;color:#9b9b9b;font-size:11px;
      display:flex;align-items:center;gap:6px;cursor:pointer;
    }
    .kt-ai-menu-btn span:first-child{
      width:22px;text-align:center;color:var(--amber);font-weight:500;font-size:11px;
    }
    .kt-ai-menu-btn:hover{
      background:#181818;color:var(--text-main);
    }

    .kt-ai-panel{
      position:fixed;
      right:16px;
      bottom:140px;
      width:min(400px,92vw);
      height:min(440px,78vh);      /* PANEL TINGGI SAMA UNTUK SEMUA MODE */
      max-height:78vh;
      background:#111;
      border-radius:10px;
      border:1px solid var(--border-soft);
      box-shadow:0 10px 26px rgba(0,0,0,.8);
      display:none;
      flex-direction:column;
      overflow:hidden;
      z-index:3000;
    }

    /* HEADER DIPAKAI HANYA SEBAGAI HOLDER TOMBOL CLOSE (NO BEZEL) */
    .kt-ai-panel-header{
      position:relative;
      padding:0;
      border:none;
      height:0;
      overflow:visible;   /* biar tombol close bisa nongol di atas */
      flex:0 0 auto;
    }
    .kt-ai-panel-title{
      display:none;       /* hidden, full space untuk iframe */
    }
    .kt-ai-panel-close{
      position:absolute;
      top:4px;
      right:6px;
      cursor:pointer;
      font-size:12px;
      color:var(--text-main);
      padding:2px 7px;
      border-radius:999px;
      background:rgba(0,0,0,0.7);
      border:1px solid var(--border-soft);
    }
    .kt-ai-panel-close:hover{
      background:rgba(0,0,0,0.9);
    }

    .kt-ai-panel-body{
      padding:0;                 /* no padding, agar iframe full */
      font-size:11px;
      color:var(--text-muted);
      display:flex;
      flex-direction:column;
      gap:0;
      flex:1;                    /* body isi penuh panel */
      min-height:0;
      overflow:hidden;           /* scrolling di dalam child (iframe/textarea) */
    }

    .kt-ai-footer{
      padding:0;
      border-top:none;
      display:none;              /* footer di-hide supaya tidak ambil space */
      justify-content:flex-end;
      gap:6px;
      flex:0 0 auto;
    }
    .kt-ai-btn{padding:4px 10px;border-radius:3px;font-size:11px;border:1px solid var(--border-soft);background:#181818;color:var(--text-muted);cursor:pointer}
    .kt-ai-btn.primary{background:var(--amber);color:#000;border-color:#f0f0f0}

    /* Overlays (search) */
    .kt-overlay{position:fixed;inset:0;background:var(--overlay);display:none;align-items:center;justify-content:center;z-index:4000}
    .kt-card{background:#0e0e0e;border:1px solid var(--border-soft);border-radius:10px;padding:12px;width:min(560px,92vw);box-shadow:0 10px 26px rgba(0,0,0,.8)}
    .kt-card-title{color:var(--amber);font-size:12px;margin-bottom:8px}
    .kt-search-input{width:100%;padding:10px;border-radius:6px;border:1px solid var(--border-soft);background:#111;color:var(--text-main);outline:none}
    .kt-close-btn{margin-top:10px;padding:6px 10px;font-size:11px;border-radius:4px;border:1px solid var(--border-soft);background:#181818;color:var(--text-muted);cursor:pointer}

    .kt-cheatsheet{position:fixed;left:50%;bottom:70px;transform:translateX(-50%);background:#0e0e0e;border:1px solid var(--border-soft);border-radius:8px;padding:8px 10px;z-index:3500;display:none;font-size:10px;color:var(--text-muted)}
    .kt-cheatsheet b{color:var(--amber)}

    /* Desktop center submenu strip (bottom) */
    @media (min-width:900px){
      .kt-submenu-strip{display:flex;justify-content:center;padding-left:0;padding-right:0}
      .kt-submenu-group{max-width:980px}
      .kt-submenu-group.active{justify-content:center}
    }

    /* Mobile tweaks */
    @media (max-width:600px){
      .kt-topbar{padding:4px 8px}
      .kt-logo{font-size:12px}
      .kt-session-clock{gap:2px;font-size:8px}
      .kt-session-item{padding:0 3px}
      .kt-session-label,.kt-session-time{font-size:8px}

      .kt-mainmenu-strip{
        justify-content:flex-start;
      }
      .kt-profile-inner{
        padding:12px 12px;
      }
    }
  </style>
<style data-id="immersive-translate-input-injected-css">.immersive-translate-input {
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 2147483647;
  display: flex;
  justify-content: center;
  align-items: center;
}
.immersive-translate-attach-loading::after {
  content: " ";

  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;

  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-2000%, -50%);
  z-index: 100;
}

.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}

.immersive-translate-input-loading {
  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;
}

@keyframes immersiveTranslateShadowRolling {
  0% {
    box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  12% {
    box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  25% {
    box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  36% {
    box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color),
      100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
  }

  50% {
    box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color),
      110px 0 var(--loading-color), 100px 0 var(--loading-color);
  }

  62% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color),
      120px 0 var(--loading-color), 110px 0 var(--loading-color);
  }

  75% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      130px 0 var(--loading-color), 120px 0 var(--loading-color);
  }

  87% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
  }

  100% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
  }
}

.immersive-translate-toast {
  display: flex;
  position: fixed;
  z-index: 2147483647;
  left: 0;
  right: 0;
  top: 1%;
  width: fit-content;
  padding: 12px 20px;
  margin: auto;
  overflow: auto;
  background: #fef6f9;
  box-shadow: 0px 4px 10px 0px rgba(0, 10, 30, 0.06);
  font-size: 15px;
  border-radius: 8px;
  color: #333;
}

.immersive-translate-toast-content {
  display: flex;
  flex-direction: row;
  align-items: center;
}

.immersive-translate-toast-hidden {
  margin: 0 20px 0 72px;
  text-decoration: underline;
  cursor: pointer;
}

.immersive-translate-toast-close {
  color: #666666;
  font-size: 20px;
  font-weight: bold;
  padding: 0 10px;
  cursor: pointer;
}

@media screen and (max-width: 768px) {
  .immersive-translate-toast {
    top: 0;
    padding: 12px 0px 0 10px;
  }
  .immersive-translate-toast-content {
    flex-direction: column;
    text-align: center;
  }
  .immersive-translate-toast-hidden {
    margin: 10px auto;
  }
}

.immersive-translate-dialog {
  position: fixed;
  z-index: 2147483647;
  left: 0;
  top: 0;
  display: flex;
  width: 300px;
  flex-direction: column;
  align-items: center;
  font-size: 15px;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  margin: auto;
  height: fit-content;
  border-radius: 20px;
  background-color: #fff;
}

.immersive-translate-modal {
  display: none;
  position: fixed;
  z-index: 2147483647;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgb(0, 0, 0);
  background-color: rgba(0, 0, 0, 0.4);
  font-size: 15px;
}

.immersive-translate-modal-content {
  background-color: #fefefe;
  margin: 10% auto;
  padding: 40px 24px 24px;
  border-radius: 12px;
  width: 350px;
  font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
    "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
    "Segoe UI Symbol", "Noto Color Emoji";
  position: relative;
}

@media screen and (max-width: 768px) {
  .immersive-translate-modal-content {
    margin: 25% auto !important;
  }
}

@media screen and (max-width: 480px) {
  .immersive-translate-modal-content {
    width: 80vw !important;
    margin: 20vh auto !important;
    padding: 20px 12px 12px !important;
  }

  .immersive-translate-modal-title {
    font-size: 14px !important;
  }

  .immersive-translate-modal-body {
    font-size: 13px !important;
    max-height: 60vh !important;
  }

  .immersive-translate-btn {
    font-size: 13px !important;
    padding: 8px 16px !important;
    margin: 0 4px !important;
  }

  .immersive-translate-modal-footer {
    gap: 6px !important;
    margin-top: 16px !important;
  }
}

.immersive-translate-modal .immersive-translate-modal-content-in-input {
  max-width: 500px;
}
.immersive-translate-modal-content-in-input .immersive-translate-modal-body {
  text-align: left;
  max-height: unset;
}

.immersive-translate-modal-title {
  text-align: center;
  font-size: 16px;
  font-weight: 700;
  color: #333333;
}

.immersive-translate-modal-body {
  text-align: center;
  font-size: 14px;
  font-weight: 400;
  color: #333333;
  margin-top: 24px;
  word-break: break-all;
}

@media screen and (max-width: 768px) {
  .immersive-translate-modal-body {
    max-height: 250px;
    overflow-y: auto;
  }
}

.immersive-translate-close {
  color: #666666;
  position: absolute;
  right: 16px;
  top: 16px;
  font-size: 20px;
  font-weight: bold;
}

.immersive-translate-close:hover,
.immersive-translate-close:focus {
  text-decoration: none;
  cursor: pointer;
}

.immersive-translate-modal-footer {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  margin-top: 24px;
}

.immersive-translate-btn {
  width: fit-content;
  color: #fff;
  background-color: #ea4c89;
  border: none;
  font-size: 14px;
  margin: 0 8px;
  padding: 9px 30px;
  border-radius: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.immersive-translate-btn-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.immersive-translate-btn:hover {
  background-color: #f082ac;
}
.immersive-translate-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
.immersive-translate-btn:disabled:hover {
  background-color: #ea4c89;
}

.immersive-translate-link-btn {
  background-color: transparent;
  color: #ea4c89;
  border: none;
  cursor: pointer;
  height: 30px;
  line-height: 30px;
}

.immersive-translate-cancel-btn {
  /* gray color */
  background-color: rgb(89, 107, 120);
}

.immersive-translate-cancel-btn:hover {
  background-color: hsl(205, 20%, 32%);
}

.immersive-translate-action-btn {
  background-color: transparent;
  color: #ea4c89;
  border: 1px solid #ea4c89;
}

.immersive-translate-btn svg {
  margin-right: 5px;
}

.immersive-translate-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #ea4c89;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
}

.immersive-translate-primary-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #ea4c89;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
}

.immersive-translate-modal input[type="radio"] {
  margin: 0 6px;
  cursor: pointer;
}

.immersive-translate-modal label {
  cursor: pointer;
}

.immersive-translate-close-action {
  position: absolute;
  top: 2px;
  right: 0px;
  cursor: pointer;
}

.imt-image-status {
  background-color: rgba(0, 0, 0, 0.5) !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  border-radius: 16px !important;
}
.imt-image-status img,
.imt-image-status svg,
.imt-img-loading {
  width: 28px !important;
  height: 28px !important;
  margin: 0 0 8px 0 !important;
  min-height: 28px !important;
  min-width: 28px !important;
  position: relative !important;
}
.imt-img-loading {
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAtFBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////oK74hAAAAPHRSTlMABBMIDyQXHwyBfFdDMSw+OjXCb+5RG51IvV/k0rOqlGRM6KKMhdvNyZBz9MaupmxpWyj437iYd/yJVNZeuUC7AAACt0lEQVRIx53T2XKiUBCA4QYOiyCbiAsuuGBcYtxiYtT3f6/pbqoYHVFO5r+iivpo6DpAWYpqeoFfr9f90DsYAuRSWkFnPO50OgR9PwiCUFcl2GEcx+N/YBh6pvKaefHlUgZd1zVe0NbYcQjGBfzrPE8Xz8aF+71D8gG6DHFPpc4a7xFiCDuhaWgKgGIJQ3d5IMGDrpS4S5KgpIm+en9f6PlAhKby4JwEIxlYJV9h5k5nee9GoxHJ2IDSNB0dwdad1NAxDJ/uXDHYmebdk4PdbkS58CIVHdYSUHTYYRWOJblWSyu2lmy3KNFVJNBhxcuGW4YBVCbYGRZwIooipHsNqjM4FbgOQqQqSKQQU9V8xmi1QlgHqQQ6DDBvRUVCDirs+EzGDGOQTCATgtYTnbCVLgsVgRE0T1QE0qHCFAht2z6dLvJQs3Lo2FQoDxWNUiBhaP4eRgwNkI+dAjVOA/kUrIDwf3CG8NfNOE0eiFotSuo+rBiq8tD9oY4Qzc6YJw99hl1wzpQvD7ef2M8QgnOGJfJw+EltQc+oX2yn907QB22WZcvlUpd143dqQu+8pCJZuGE4xCuPXJqqcs5sNpsI93Rmzym1k4Npk+oD1SH3/a3LOK/JpUBpWfqNySxWzCfNCUITuDG5dtuphrUJ1myeIE9bIsPiKrfqTai5WZxbhtNphYx6GEIHihyGFTI69lje/rxajdh0s0msZ0zYxyPLhYCb1CyHm9Qsd2H37Y3lugVwL9kNh8Ot8cha6fUNQ8nuXi5z9/ExsAO4zQrb/ev1yrCB7lGyQzgYDGuxq1toDN/JGvN+HyWNHKB7zEoK+PX11e12G431erGYzwmytAWU56fkMHY5JJnDRR2eZji3AwtIcrEV8Cojat/BdQ7XOwGV1e1hDjGGjXbdArm8uJZtCH5MbcctVX8A1WpqumJHwckAAAAASUVORK5CYII=");
  background-size: 28px 28px;
  animation: image-loading-rotate 1s linear infinite !important;
}

.imt-image-status span {
  color: var(--bg-2, #fff) !important;
  font-size: 14px !important;
  line-height: 14px !important;
  font-weight: 500 !important;
  font-family: "PingFang SC", Arial, sans-serif !important;
}

.imt-primary-button {
  display: flex;
  padding: 12px 80px;
  justify-content: center;
  align-items: center;
  gap: 8px;
  border-radius: 8px;
  background: #ea4c89;
  color: #fff;
  font-size: 16px;
  font-style: normal;
  font-weight: 700;
  line-height: 24px;
  border: none;
  cursor: pointer;
}

.imt-retry-text {
  color: #999;
  text-align: center;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 21px;
  cursor: pointer;
}

.imt-action-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.imt-modal-content-text {
  text-align: left;
  color: #333;
  font-size: 16px;
  font-weight: 400;
  line-height: 24px;
}

@keyframes image-loading-rotate {
  from {
    transform: rotate(360deg);
  }
  to {
    transform: rotate(0deg);
  }
}

.imt-linear-gradient-text {
  background: linear-gradient(90deg, #00a6ff 0%, #c369ff 52.4%, #ff4590 100%);
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.imt-flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

.imt-linear-black-btn {
  border-radius: 50px;
  background: linear-gradient(66deg, #222 19%, #696969 94.25%);
  height: 48px;
  width: 100%;
  color: #fff;
  font-size: 16px;
  font-weight: 700;
  display: flex;
  align-items: center;
  cursor: pointer;
  justify-content: center;
}
</style></head>
<body>
  <div class="kt-root">
    <!-- IFRAME -->
    <div class="kt-iframe-layer" id="kt-iframe-layer" style="pointer-events: auto;"><iframe title="embedded" loading="lazy" src="https://kuantara112.github.io/Kuantara_Terminal_Charts/news_feeds_247.html"></iframe></div>

    <!-- TOP BAR -->
    <header class="kt-topbar">
      <div class="kt-topbar-left">
        <div class="kt-logo">KUANTARA TERMINAL</div>
        <div class="kt-session-clock" id="kt-session-clock">
          <div class="kt-session-item"><span class="kt-session-label">SYD</span><span class="kt-session-time" data-tz="10">13:33</span></div>
          <div class="kt-session-item"><span class="kt-session-label">TYO</span><span class="kt-session-time" data-tz="9">12:33</span></div>
          <div class="kt-session-item"><span class="kt-session-label">LDN</span><span class="kt-session-time" data-tz="0">03:33</span></div>
          <div class="kt-session-item"><span class="kt-session-label">NYC</span><span class="kt-session-time" data-tz="-5">22:33</span></div>
        </div>
      </div>
    </header>

    <!-- MAIN MENU (TOP) -->
    <nav class="kt-mainmenu-strip kt-hide-top" id="kt-mainmenu-strip">
      <button class="kt-mainmenu-btn active" data-menu="0"><span>0</span><span>Markets</span></button>
      <button class="kt-mainmenu-btn" data-menu="1"><span>1</span><span>News</span></button>
      <button class="kt-mainmenu-btn" data-menu="2"><span>2</span><span>Macroeconomic</span></button>
      <button class="kt-mainmenu-btn" data-menu="3"><span>3</span><span>Geo-Economic</span></button>
      <button class="kt-mainmenu-btn" data-menu="4"><span>4</span><span>Metrics</span></button>
      <button class="kt-mainmenu-btn" data-menu="5"><span>5</span><span>Companies</span></button>
      <button class="kt-mainmenu-btn" data-menu="6"><span>6</span><span>Charts</span></button>
      <button class="kt-mainmenu-btn" data-menu="7"><span>7</span><span>Screener</span></button>
      <button class="kt-mainmenu-btn" data-menu="8"><span>8</span><span>Research</span></button>
      <button class="kt-mainmenu-btn" data-menu="9"><span>9</span><span>Tools</span></button>
    </nav>

    <!-- BREADCRUMB -->
    <section class="kt-content">
      <div class="kt-content-header kt-hide-top" id="kt-content-header">
        <div class="kt-breadcrumb">
          <span class="kt-breadcrumb-main" id="breadcrumb-main">0 · Markets</span>
          <span class="kt-breadcrumb-sub" id="breadcrumb-sub">Overview</span>
        </div>
      </div>
    </section>

    <!-- STATUS -->
    <div class="kt-statusbar kt-hide-bottom" id="kt-statusbar">
      <div class="kt-status-msg" id="kt-status-msg">24/7 FEED MODE</div>
    </div>
  </div>

  <!-- SUB MENU (BOTTOM STRIP) -->
  <nav class="kt-submenu-strip kt-hide-bottom" id="kt-submenu-strip">
    <!-- 0. Markets -->
    <div class="kt-submenu-group active" data-menu-sub="0">
      <button class="kt-submenu-btn active" data-menu="0" data-sub-index="0">Overview</button>
      <button class="kt-submenu-btn" data-menu="0" data-sub-index="1">Forex</button>
      <button class="kt-submenu-btn" data-menu="0" data-sub-index="2">Fixed</button>
      <button class="kt-submenu-btn" data-menu="0" data-sub-index="3">Commodities</button>
      <button class="kt-submenu-btn" data-menu="0" data-sub-index="4">Equities</button>
      <button class="kt-submenu-btn" data-menu="0" data-sub-index="5">Crypto</button>
    </div>

    <!-- 1. News -->
    <div class="kt-submenu-group" data-menu-sub="1">
      <button class="kt-submenu-btn" data-menu="1" data-sub-index="0">Insights</button>
      <button class="kt-submenu-btn" data-menu="1" data-sub-index="1">Calendar</button>
      <button class="kt-submenu-btn" data-menu="1" data-sub-index="2">Global</button>
      <button class="kt-submenu-btn" data-menu="1" data-sub-index="3">Recap</button>
      <button class="kt-submenu-btn" data-menu="1" data-sub-index="4">Indonesia</button>
    </div>

    <!-- 2. Macroeconomic -->
    <div class="kt-submenu-group" data-menu-sub="2">
      <button class="kt-submenu-btn" data-menu="2" data-sub-index="0">US Macro</button>
      <button class="kt-submenu-btn" data-menu="2" data-sub-index="1">Central Bank</button>
      <button class="kt-submenu-btn" data-menu="2" data-sub-index="2">Countries</button>
    </div>

    <!-- 3. Geo-Economic -->
    <div class="kt-submenu-group" data-menu-sub="3">
      <button class="kt-submenu-btn" data-menu="3" data-sub-index="0">Trade &amp; Shipping</button>
      <button class="kt-submenu-btn" data-menu="3" data-sub-index="1">Supply Chain</button>
      <button class="kt-submenu-btn" data-menu="3" data-sub-index="2">Demographics</button>
      <button class="kt-submenu-btn" data-menu="3" data-sub-index="3">Resources</button>
      <button class="kt-submenu-btn" data-menu="3" data-sub-index="4">Satellite</button>
    </div>

    <!-- 4. Metrics -->
    <div class="kt-submenu-group" data-menu-sub="4">
      <button class="kt-submenu-btn" data-menu="4" data-sub-index="0">Macro</button>
      <button class="kt-submenu-btn" data-menu="4" data-sub-index="1">Liquidity</button>
      <button class="kt-submenu-btn" data-menu="4" data-sub-index="2">Sentiment</button>
      <button class="kt-submenu-btn" data-menu="4" data-sub-index="3">Seasonality</button>
      <button class="kt-submenu-btn" data-menu="4" data-sub-index="4">COT</button>
      <button class="kt-submenu-btn" data-menu="4" data-sub-index="5">FI</button>
      <button class="kt-submenu-btn" data-menu="4" data-sub-index="6">Breadth</button>
      <button class="kt-submenu-btn" data-menu="4" data-sub-index="7">Flows</button>
      <button class="kt-submenu-btn" data-menu="4" data-sub-index="8">Volatility</button>
    </div>

    <!-- 5. Companies -->
    <div class="kt-submenu-group" data-menu-sub="5">
      <button class="kt-submenu-btn" data-menu="5" data-sub-index="0">United States</button>
      <button class="kt-submenu-btn" data-menu="5" data-sub-index="1">Indonesia</button>
      <button class="kt-submenu-btn" data-menu="5" data-sub-index="2">Blockchain Projects</button>
    </div>

    <!-- 6. Charts -->
    <div class="kt-submenu-group" data-menu-sub="6">
      <button class="kt-submenu-btn" data-menu="6" data-sub-index="0">Technical</button>
      <button class="kt-submenu-btn" data-menu="6" data-sub-index="1">Fundamental</button>
      <button class="kt-submenu-btn" data-menu="6" data-sub-index="2">Economy</button>
    </div>

    <!-- 7. Screener -->
    <div class="kt-submenu-group" data-menu-sub="7">
      <button class="kt-submenu-btn" data-menu="7" data-sub-index="0">US Stocks</button>
      <button class="kt-submenu-btn" data-menu="7" data-sub-index="1">ID Stocks</button>
      <button class="kt-submenu-btn" data-menu="7" data-sub-index="2">Crypto</button>
      <button class="kt-submenu-btn" data-menu="7" data-sub-index="3">Custom</button>
    </div>

    <!-- 8. Research -->
    <div class="kt-submenu-group" data-menu-sub="8">
      <button class="kt-submenu-btn" data-menu="8" data-sub-index="0">Internal</button>
      <button class="kt-submenu-btn" data-menu="8" data-sub-index="1">Institutions</button>
      <button class="kt-submenu-btn" data-menu="8" data-sub-index="2">Reports</button>
    </div>

    <!-- 9. Tools -->
    <div class="kt-submenu-group" data-menu-sub="9">
      <button class="kt-submenu-btn" data-menu="9" data-sub-index="0">Journal</button>
      <button class="kt-submenu-btn" data-menu="9" data-sub-index="1">Education</button>
      <button class="kt-submenu-btn" data-menu="9" data-sub-index="2">Notes</button>
      <button class="kt-submenu-btn" data-menu="9" data-sub-index="3">Quantitative</button>
      <button class="kt-submenu-btn" data-menu="9" data-sub-index="4">Calculator</button>
      <button class="kt-submenu-btn" data-menu="9" data-sub-index="5">Others</button>
    </div>
  </nav>

  <!-- PROFILE PAGE (PAGE BARU) -->
  <div class="kt-profile-page" id="kt-profile-page" style="display: none;">
    <div class="kt-profile-inner">
      <div class="kt-profile-header">
        <div>
          <div class="kt-profile-title">User Profile</div>
          <div class="kt-profile-name">Guest User</div>
          <div class="kt-profile-meta">
            Kuantara Terminal · Single-seat license<br>
            Last login: —
          </div>
        </div>
        <div>
          <span class="kt-badge">ACTIVE PLAN</span>
        </div>
      </div>

      <div class="kt-profile-grid">
        <div class="kt-profile-card">
          <div class="kt-profile-card-title">Account</div>
          <div class="kt-profile-card-body">
            Name : Guest User<br>
            Email: guest@example.com<br>
            Role : Retail Trader / Analyst
          </div>
        </div>

        <div class="kt-profile-card">
          <div class="kt-profile-card-title">Subscription</div>
          <div class="kt-profile-card-body">
            Plan          : Kuantara Terminal Standard<br>
            Status        : Trial<br>
            Time Left     : 7 days<br>
            Renewal Mode  : Manual
          </div>
        </div>

        <div class="kt-profile-card">
          <div class="kt-profile-card-title">Contact &amp; Support</div>
          <div class="kt-profile-card-body">
            Telegram : @kuantara<br>
            Email    : support@kuantara.com<br>
            Priority : Standard
          </div>
        </div>

        <div class="kt-profile-card">
          <div class="kt-profile-card-title">Usage Snapshot</div>
          <div class="kt-profile-card-body">
            Terminals Active : 1 / 2<br>
            Last 24h Logins : 3<br>
            Most Used Page  : Markets · Overview
          </div>
        </div>
      </div>

      <div class="kt-profile-menu">
        <button class="kt-profile-menu-btn">Settings</button>
        <button class="kt-profile-menu-btn">Notifications</button>
        <button class="kt-profile-menu-btn">Store</button>
      </div>

      <div class="kt-profile-footer">
        Developed by Kuantara Analytics · Informasi di dalam terminal ini bersifat edukatif dan bukan merupakan saran investasi atau ajakan untuk melakukan transaksi finansial.
      </div>
    </div>
  </div>

  <!-- BOTTOM NAV (3 ITEM) -->
  <nav class="kt-bottom-nav" id="kt-bottom-nav">
    <div class="kt-bottom-item" data-bottom-role="home">
      <span>Home</span>
    </div>
    <div class="kt-bottom-item active" data-bottom-role="247">
      <span>24/7</span>
    </div>
    <div class="kt-bottom-item" data-bottom-role="profile">
      <span>Profile</span>
    </div>
  </nav>

  <!-- FLOATING FAB + MENU + PANEL -->
  <div class="kt-ai-fab" id="kt-ai-fab">≡</div>

  <div class="kt-ai-menu" id="kt-ai-menu" style="display: none;">
    <button class="kt-ai-menu-btn" data-pane="ai"><span>AI</span><span>Kuantara AI</span></button>
    <button class="kt-ai-menu-btn" data-pane="mini"><span>MC</span><span>Mini Chart</span></button>
    <button class="kt-ai-menu-btn" data-pane="notes"><span>NT</span><span>Notes</span></button>
    <button class="kt-ai-menu-btn" data-pane="signals"><span>SG</span><span>Signals</span></button>
    <button class="kt-ai-menu-btn" data-pane="group"><span>GC</span><span>Group Chat</span></button>
  </div>

  <div class="kt-ai-panel" id="kt-ai-panel" style="display: none;">
    <div class="kt-ai-panel-header">
      <div class="kt-ai-panel-title">
        <span id="kt-ai-title">Kuantara AI Assistant</span>
        <span id="kt-ai-subtitle">Kuantara AI terintegrasi langsung di dalam panel ini.</span>
      </div>
      <div class="kt-ai-panel-close" id="kt-ai-close">✕</div>
    </div>
    <div class="kt-ai-panel-body" id="kt-ai-body"><iframe src="https://kuantara112.github.io/Kuantara_Terminal_Charts/kuantara_ai.html" title="Kuantara AI" loading="lazy" style="width:100%;height:100%;border:0;display:block;"></iframe></div>
    <div class="kt-ai-footer" id="kt-ai-footer"></div>
  </div>

  <!-- SEARCH -->
  <div class="kt-overlay" id="kt-search-ovl" aria-hidden="true">
    <div class="kt-card">
      <div class="kt-card-title">Search</div>
      <input id="kt-search-input" class="kt-search-input" type="text" placeholder="Cari menu/sub… (Enter untuk lompat, Esc tutup)">
      <button class="kt-close-btn" id="kt-search-close">Close</button>
    </div>
  </div>

  <!-- CHEATSHEET -->
  <div class="kt-cheatsheet" id="kt-cheatsheet">
    <div><b>Alt+0–9</b> Menu · <b>Ctrl+1–9</b> Sub · <b>Esc</b>=Alt+0 · <b>Ctrl+F</b> Search · <b>Tab</b> Profile</div>
  </div>

  <script>
    (function(){
      const mainButtons = document.querySelectorAll(".kt-mainmenu-btn");
      const bottomItems = document.querySelectorAll(".kt-bottom-item");
      const submenuGroups = document.querySelectorAll(".kt-submenu-group");
      const submenuButtons = document.querySelectorAll(".kt-submenu-btn");

      const breadcrumbMain = document.getElementById("breadcrumb-main");
      const breadcrumbSub  = document.getElementById("breadcrumb-sub");
      const statusMsg      = document.getElementById("kt-status-msg");
      const sessionTimes   = document.querySelectorAll(".kt-session-time");

      const aiFab    = document.getElementById("kt-ai-fab");
      const aiMenu   = document.getElementById("kt-ai-menu");
      const aiPanel  = document.getElementById("kt-ai-panel");
      const aiClose  = document.getElementById("kt-ai-close");
      const aiTitle  = document.getElementById("kt-ai-title");
      const aiSubtitle = document.getElementById("kt-ai-subtitle");
      const aiBody   = document.getElementById("kt-ai-body");
      const aiFooter = document.getElementById("kt-ai-footer");
      const aiMenuButtons = document.querySelectorAll(".kt-ai-menu-btn");

      const searchOvl   = document.getElementById("kt-search-ovl");
      const searchInput = document.getElementById("kt-search-input");
      const searchClose = document.getElementById("kt-search-close");

      const iframeLayer   = document.getElementById("kt-iframe-layer");
      const mainmenuStrip = document.getElementById("kt-mainmenu-strip");
      const contentHeader = document.getElementById("kt-content-header");
      const statusbar     = document.getElementById("kt-statusbar");
      const submenuStrip  = document.getElementById("kt-submenu-strip");
      const bottomNav     = document.getElementById("kt-bottom-nav");
      const profilePage   = document.getElementById("kt-profile-page");

      const TOP_TRIGGER_ZONE = 60;
      const BOTTOM_TRIGGER_ZONE = 120;
      const HIDE_DELAY = 1800;
      const CLICK_GRACE = 450;
      let hideTimer=null, graceTimer=null;

      let activeMenu=0;
      let activeBottom="home";

      /* Map menu:sub -> iframe URL */
      const IFRAME_MAP = {
        // Markets
        "0:0":"https://kuantara112.github.io/Kuantara_Terminal_Charts/overview_markets.html",
        "0:1":"https://kuantara112.github.io/Kuantara_Terminal_Charts/markets_forex.html",
        "0:2":"https://kuantara112.github.io/Kuantara_Terminal_Charts/markets_fixed.html",
        "0:3":"https://kuantara112.github.io/Kuantara_Terminal_Charts/markets_commodities.html",
        "0:4":"https://kuantara112.github.io/Kuantara_Terminal_Charts/markets_equities.html",
        "0:5":"https://kuantara112.github.io/Kuantara_Terminal_Charts/markets_crypto.html",

        // News
        "1:0":"https://kuantara112.github.io/Kuantara_Terminal_Charts/news_insights.html",
        "1:1":"https://kuantara112.github.io/Kuantara_Terminal_Charts/news_calendar.html",
        "1:2":"https://44e53ad6-8cf6-4090-9e60-c9e985282fe0.filesusr.com/html/5e69ae_59c85b29326635aadaac1f2286d8f292.html",

        // Macroeconomic
        "2:0":"https://kuantara112.github.io/Kuantara_Terminal_Charts/usmacro.html",

        // Charts
        "6:0":"https://kuantara112.github.io/Kuantara_Terminal_Charts/technical_charts.html"
      };

      const MINI_CHART_URL  = "https://kuantara112.github.io/Kuantara_Terminal_Charts/xauusd_tradingview.html";
      const FEED_247_URL    = "https://kuantara112.github.io/Kuantara_Terminal_Charts/news_feeds_247.html";
      const KUANTARA_AI_URL = "https://kuantara112.github.io/Kuantara_Terminal_Charts/kuantara_ai.html";

      function injectIframe(url){
        if(!url){ iframeLayer.innerHTML=""; return; }
        iframeLayer.innerHTML = '<iframe title="embedded" loading="lazy" src="'+url+'"></iframe>';
        updateIframeInteractivity();
      }

      /* pointerEvents SELALU auto supaya mobile bisa scroll */
      function updateIframeInteractivity(){
        iframeLayer.style.pointerEvents = "auto";
      }

      function renderContent(menuIndex, subIndex){
        const key = menuIndex+":"+subIndex;
        injectIframe(IFRAME_MAP[key]);
        statusMsg.textContent = IFRAME_MAP[key] ? "EMBED: "+IFRAME_MAP[key] : "READY";
      }

      function setActiveMenu(menuIndex){
        activeMenu = menuIndex;
        document.querySelectorAll(".kt-mainmenu-btn").forEach(btn=>{
          btn.classList.toggle("active", Number(btn.getAttribute("data-menu"))===menuIndex);
        });
        submenuGroups.forEach(group=>{
          group.classList.toggle("active", Number(group.getAttribute("data-menu-sub"))===menuIndex);
        });
        const activeMain = document.querySelector('.kt-mainmenu-btn[data-menu="'+menuIndex+'"] span:nth-child(2)');
        if(activeMain) breadcrumbMain.textContent = menuIndex+" · "+activeMain.textContent.trim();

        const firstSub = document.querySelector('.kt-submenu-btn[data-menu="'+menuIndex+'"][data-sub-index="0"]');
        if(firstSub){ setActiveSub(menuIndex,0); } else { breadcrumbSub.textContent=""; renderContent(menuIndex,-1); }

        statusMsg.textContent = "ACTIVE MENU: "+menuIndex;
      }

      function setActiveSub(menuIndex, subIndex){
        submenuButtons.forEach(btn=>{
          const m=Number(btn.getAttribute("data-menu"));
          const s=Number(btn.getAttribute("data-sub-index"));
          btn.classList.toggle("active", m===menuIndex && s===subIndex);
        });
        const sub = document.querySelector('.kt-submenu-btn[data-menu="'+menuIndex+'"][data-sub-index="'+subIndex+'"]');
        if(sub){ breadcrumbSub.textContent=sub.textContent.trim(); statusMsg.textContent="ACTIVE: "+menuIndex+" · "+breadcrumbSub.textContent; }
        else   { breadcrumbSub.textContent=""; statusMsg.textContent="ACTIVE MENU: "+menuIndex+" · (no sub)"; }

        renderContent(menuIndex, subIndex);
      }

      function setBottomActive(role){
        activeBottom = role;
        bottomItems.forEach(item=>{
          item.classList.toggle("active", item.getAttribute("data-bottom-role")===role);
        });
      }

      function showProfilePage(){
        profilePage.style.display="block";
      }
      function hideProfilePage(){
        profilePage.style.display="none";
      }

      function setupEventListeners() {
        /* Main menu */
        mainButtons.forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            if(activeBottom!=="home"){
              setBottomActive("home");
              hideProfilePage();
            }
            setActiveMenu(Number(btn.getAttribute("data-menu")));
            showAllBars();
            scheduleHide();
          });
        });

        /* Submenu */
        submenuButtons.forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            if(activeBottom!=="home"){
              setBottomActive("home");
              hideProfilePage();
            }
            const menuIndex = Number(btn.getAttribute("data-menu"));
            const subIndex = Number(btn.getAttribute("data-sub-index"));
            setActiveSub(menuIndex, subIndex);
            showAllBars();
            scheduleHide();
          });
        });

        /* Bottom bar behaviour (HOME / 24/7 / PROFILE) */
        bottomItems.forEach(item=>{
          item.addEventListener("click",(e)=>{
            e.stopPropagation();
            const role = item.getAttribute("data-bottom-role");

            if(role==="home"){
              setBottomActive("home");
              hideProfilePage();
              setActiveMenu(0);
              setActiveSub(0,0);
              showAllBars();
              scheduleHide();
            }
            else if(role==="247"){
              setBottomActive("247");
              hideProfilePage();
              hideAllBars();
              injectIframe(FEED_247_URL);
              statusMsg.textContent="24/7 FEED MODE";
            }
            else if(role==="profile"){
              setBottomActive("profile");
              hideAllBars();
              injectIframe("");
              showProfilePage();
            }
          });
        });
      }

      /* SEARCH */
      function buildSearchIndex(){
        const idx=[];
        document.querySelectorAll(".kt-mainmenu-btn").forEach(btn=>{
          const menuIdx=Number(btn.getAttribute("data-menu"));
          const name=btn.querySelector("span:nth-child(2)")?.textContent?.trim()||"";
          idx.push({label:name,menu:menuIdx,sub:null,type:"menu"});
        });
        document.querySelectorAll(".kt-submenu-btn").forEach(btn=>{
          const menuIdx=Number(btn.getAttribute("data-menu"));
          const subIdx=Number(btn.getAttribute("data-sub-index"));
          const name=btn.textContent.trim();
          idx.push({label:name,menu:menuIdx,sub:subIdx,type:"sub"});
        });
        return idx;
      }
      function findBestMatch(index,qRaw){
        const q=qRaw.toLowerCase();
        return index.find(it=>it.label.toLowerCase()===q)
            || index.find(it=>it.label.toLowerCase().startsWith(q))
            || index.find(it=>it.label.toLowerCase().includes(q))
            || null;
      }

      let searchIndex=buildSearchIndex();
      function openOverlay(el){ el.style.display="flex"; updateIframeInteractivity(); }
      function closeOverlay(el){ el.style.display="none"; updateIframeInteractivity(); }

      function openSearch(){
        searchIndex=buildSearchIndex();
        openOverlay(searchOvl);
        setTimeout(()=>searchInput.focus(),10);
        statusMsg.textContent="SEARCH: active";
        if(activeBottom==="home"){
          showAllBars();
        }
      }
      function closeSearch(){ closeOverlay(searchOvl); statusMsg.textContent="SEARCH: closed"; if(activeBottom==="home") scheduleHide(); }

      searchClose.addEventListener("click", closeSearch);
      searchOvl.addEventListener("click",(e)=>{ if(e.target===searchOvl) closeSearch(); });
      searchInput.addEventListener("keydown",(e)=>{
        if(e.key==="Escape"){ e.preventDefault(); closeSearch(); return; }
        if(e.key==="Enter"){
          e.preventDefault();
          const q=(searchInput.value||"").trim();
          if(!q){ statusMsg.textContent="SEARCH: empty"; closeSearch(); return; }
          const match=findBestMatch(searchIndex,q);
          if(match){
            if(activeBottom!=="home"){
              setBottomActive("home");
              hideProfilePage();
            }
            setActiveMenu(match.menu);
            if(match.sub!==null) setActiveSub(match.menu,match.sub);
            statusMsg.textContent=`SEARCH goto: ${match.label} (${match.type})`;
          }
          else{
            statusMsg.textContent=`SEARCH: "${q}" not found`;
          }
          closeSearch();
        }
      });

      /* AUTOHIDE BARS – hanya aktif di HOME */
      function showTopBars(){
        if(activeBottom!=="home") return;
        mainmenuStrip.classList.remove("kt-hide-top");
        contentHeader.classList.remove("kt-hide-top");
        clearTimeout(graceTimer);
        graceTimer=setTimeout(()=>{},CLICK_GRACE);
        updateIframeInteractivity();
      }

      function hideTopBars(){
        mainmenuStrip.classList.add("kt-hide-top");
        contentHeader.classList.add("kt-hide-top");
        updateIframeInteractivity();
      }

      function showBottomBars(){
        if(activeBottom!=="home") return;
        submenuStrip.classList.remove("kt-hide-bottom");
        statusbar.classList.remove("kt-hide-bottom");
        clearTimeout(graceTimer);
        graceTimer=setTimeout(()=>{},CLICK_GRACE);
        updateIframeInteractivity();
      }

      function hideBottomBars(){
        submenuStrip.classList.add("kt-hide-bottom");
        statusbar.classList.add("kt-hide-bottom");
        updateIframeInteractivity();
      }

      function showAllBars(){
        showTopBars();
        showBottomBars();
      }

      function hideAllBars(){
        hideTopBars();
        hideBottomBars();
      }

      function scheduleHide(){
        if(activeBottom!=="home") return;
        clearTimeout(hideTimer);
        hideTimer=setTimeout(()=>{ hideAllBars(); }, HIDE_DELAY);
      }

      function handleMouseMove(e){
        if(activeBottom!=="home") return;
        const y = e.clientY;
        const h = window.innerHeight;
        const nearTop = y <= TOP_TRIGGER_ZONE;
        const nearBottom = y >= (h - BOTTOM_TRIGGER_ZONE);

        if (nearTop) {
          showTopBars();
          scheduleHide();
        } else if (nearBottom) {
          showBottomBars();
          scheduleHide();
        }
      }

      window.addEventListener("mousemove", handleMouseMove, {passive:true});

      window.addEventListener("touchstart",(e)=>{
        if(activeBottom!=="home") return;
        const y=e.touches[0]?.clientY??0, h=window.innerHeight;
        const nearTop = y <= TOP_TRIGGER_ZONE;
        const nearBottom = y >= (h - BOTTOM_TRIGGER_ZONE);

        if(nearTop) showTopBars();
        if(nearBottom) showBottomBars();
        scheduleHide();
      },{passive:true});

      [mainmenuStrip, contentHeader, submenuStrip, statusbar, bottomNav].forEach(el=>{
        el.addEventListener("mouseenter", ()=>{
          if(activeBottom!=="home" && el!==bottomNav) return;
          clearTimeout(hideTimer);
          if (el === mainmenuStrip || el === contentHeader) {
            showTopBars();
          } else if (el !== bottomNav) {
            showBottomBars();
          }
        });
        el.addEventListener("mouseleave", ()=>{
          if(el===bottomNav) return;
          scheduleHide();
        });
        el.addEventListener("pointerdown", ()=>{ clearTimeout(hideTimer); });
        el.addEventListener("click", (e)=>{ e.stopPropagation(); });
      });

      document.querySelectorAll('.kt-mainmenu-btn, .kt-submenu-btn').forEach(btn=>{
        btn.addEventListener('pointerdown', (e)=>{
          e.stopPropagation();
          showAllBars();
          updateIframeInteractivity();
        });
        btn.addEventListener('click', (e)=>{ e.stopPropagation(); });
      });

      /* FLOATING MENU LOGIC */
      function toggleAiMenu(force){
        const isOpen = aiMenu.style.display==="flex";
        const next = typeof force==="boolean" ? force : !isOpen;
        aiMenu.style.display = next ? "flex" : "none";
      }

      function openAiPane(mode){
        if(mode==="ai"){
          aiTitle.textContent = "Kuantara AI Assistant";
          aiSubtitle.textContent = "Kuantara AI terintegrasi langsung di dalam panel ini.";
          aiBody.innerHTML =
            '<iframe src="'+KUANTARA_AI_URL+'" ' +
            'title="Kuantara AI" loading="lazy" ' +
            'style="width:100%;height:100%;border:0;display:block;"></iframe>';
          aiFooter.innerHTML = '';
          aiPanel.style.display="flex";
          if(activeBottom==="home") showAllBars();
        }else if(mode==="mini"){
          aiTitle.textContent = "Mini Chart";
          aiSubtitle.textContent = "Chart kecil untuk quick view XAUUSD.";
          aiBody.innerHTML =
            '<iframe src="'+MINI_CHART_URL+'" ' +
            'title="Mini Chart" loading="lazy" ' +
            'style="width:100%;height:100%;border:0;display:block;"></iframe>';
          aiFooter.innerHTML = '';
          aiPanel.style.display="flex";
          if(activeBottom==="home") showAllBars();
        }else if(mode==="notes"){
          aiTitle.textContent = "Notes";
          aiSubtitle.textContent = "Catatan cepat untuk ide trade dan macro view.";
          aiBody.innerHTML =
            '<textarea id="kt-notes-area" ' +
            'style="width:100%;height:100%;background:#111;border:none;border-radius:0;' +
            'color:var(--text-main);padding:6px;font-size:11px;resize:none;box-sizing:border-box;outline:none;overflow:auto;" ' +
            'placeholder="Tulis catatan di sini..."></textarea>';
          aiFooter.innerHTML = '';

          const notesArea = document.getElementById("kt-notes-area");
          if(window.localStorage){
            const saved = localStorage.getItem("kuantara_notes");
            if(saved) notesArea.value = saved;
            notesArea.addEventListener("input", ()=>localStorage.setItem("kuantara_notes", notesArea.value));
          }
          aiPanel.style.display="flex";
          if(activeBottom==="home") showAllBars();
        }else if(mode==="signals"){
          aiTitle.textContent = "Signals";
          aiSubtitle.textContent = "Ringkasan sinyal trading & alert utama.";
          aiBody.innerHTML =
            '<div style="width:100%;height:100%;padding:8px 10px;box-sizing:border-box;font-size:10px;line-height:1.5;color:var(--text-muted);overflow:auto;">' +
            'Panel ini akan menampilkan sinyal dari sistem Kuantara (algo, screener, atau alert eksternal). ' +
            'Integrasi backend bisa diarahkan untuk push sinyal terbaru ke area ini secara realtime.' +
            '</div>';
          aiFooter.innerHTML = '';
          aiPanel.style.display="flex";
          if(activeBottom==="home") showAllBars();
        }else if(mode==="group"){
          aiTitle.textContent = "Group Chat";
          aiSubtitle.textContent = "Chat antar user Kuantara Terminal (prototype).";
          aiBody.innerHTML =
            '<div style="width:100%;height:100%;padding:8px 10px;box-sizing:border-box;font-size:10px;line-height:1.5;color:var(--text-muted);overflow:auto;">' +
              'Fitur ini didesain sebagai ruang obrolan realtime antar pengguna Kuantara Terminal. ' +
              'Integrasi backend (Telegram/Discord/WebSocket) bisa dihubungkan ke panel ini di tahap berikutnya.' +
              '<div style="margin-top:8px;padding:6px 8px;border-radius:6px;border:1px dashed var(--border-soft);font-size:10px;color:var(--text-muted);">' +
              'Prototype: belum terhubung ke server chat. Di versi production, area ini akan menampilkan pesan, daftar user online, dan input box untuk mengirim chat.' +
              '</div>' +
            '</div>';
          aiFooter.innerHTML = '';
          aiPanel.style.display="flex";
          if(activeBottom==="home") showAllBars();
        }
      }

      aiFab.addEventListener("click", (e)=>{
        e.stopPropagation();
        toggleAiMenu();
        if(activeBottom==="home") showAllBars();
      });

      aiMenuButtons.forEach(btn=>{
        btn.addEventListener("click",(e)=>{
          e.stopPropagation();
          const pane = btn.getAttribute("data-pane");
          toggleAiMenu(false);
          openAiPane(pane);
        });
      });

      aiClose.addEventListener("click", ()=>{
        aiPanel.style.display="none";
      });

      window.addEventListener("click",(e)=>{
        if(!aiFab.contains(e.target) && !aiMenu.contains(e.target) && !aiPanel.contains(e.target)){
          toggleAiMenu(false);
        }
      });

      aiPanel.addEventListener("click",(e)=>{ e.stopPropagation(); });

      /* Keyboard */
      window.addEventListener("keydown",(e)=>{
        if(e.ctrlKey && (e.key==="f"||e.key==="F")){ e.preventDefault(); openSearch(); return; }
        if(e.altKey && !e.ctrlKey && !e.shiftKey){
          const k=e.key; if(k>="0"&&k<="9"){
            e.preventDefault();
            if(activeBottom!=="home"){
              setBottomActive("home");
              hideProfilePage();
            }
            setActiveMenu(Number(k));
            showAllBars();
            scheduleHide();
            return;
          }
        }
        if(e.ctrlKey && !e.altKey){
          const k=e.key; if(k>="1"&&k<="9"){
            e.preventDefault();
            if(activeBottom!=="home"){
              setBottomActive("home");
              hideProfilePage();
            }
            setActiveSub(activeMenu, Number(k)-1);
            showAllBars();
            scheduleHide();
            return;
          }
        }
        if(e.key==="Escape"){
          e.preventDefault();
          if(activeBottom!=="home"){
            setBottomActive("home");
            hideProfilePage();
          }
          setActiveMenu(0);
          setActiveSub(0,0);
          showAllBars();
          scheduleHide();
          return;
        }
        if(e.key==="Tab"){
          e.preventDefault();
          setBottomActive("profile");
          hideAllBars();
          injectIframe("");
          showProfilePage();
          return;
        }
        if(e.key==="Shift" && !e.repeat && !e.ctrlKey && !e.altKey){
          const cheats=document.getElementById("kt-cheatsheet");
          cheats.style.display="block"; setTimeout(()=>{cheats.style.display="none";},2000);
          if(activeBottom==="home"){ showAllBars(); scheduleHide(); }
          return;
        }
      });

      /* Clocks */
      function pad2(n){return n<10?"0"+n:""+n}
      function updateSessions(){
        const now=new Date();
        const utc=Date.UTC(now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate(),now.getUTCHours(),now.getUTCMinutes(),now.getUTCSeconds());
        sessionTimes.forEach(el=>{
          const offset=Number(el.getAttribute("data-tz"))||0;
          const d=new Date(utc+offset*3600*1000);
          el.textContent=pad2(d.getUTCHours())+":"+pad2(d.getUTCMinutes());
        });
      }
      updateSessions(); setInterval(updateSessions,1000);

      /* Init */
      setupEventListeners();
      setActiveMenu(0);
      setBottomActive("home");
      hideProfilePage();
      showAllBars();
      setTimeout(()=>{ hideAllBars(); }, 1000);
      updateIframeInteractivity();
    })();
  </script>

</body><chatgpt-sidebar data-gpts-theme="light"></chatgpt-sidebar><div id="immersive-translate-browser-popup" style="all: initial"></div></html>
