<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Kuantara â€“ Doc Editor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Fira Code -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600;700&display=swap"/>

  <style>
    :root {
      --bg-root:#000000;
      --bg-main:#111111;
      --border-soft:#2b2b2b;
      --text-main:#f5f5f5;
      --text-muted:#9b9b9b;
      --accent:#ffbf00;

      --fs-title:14px;
      --fs-subtitle:12px;
      --fs-body:11px;
      --fs-small:10px;

      --card-radius:4px;
      --card-padding-v:12px;
      --card-padding-h:16px;
    }

    *{
      box-sizing:border-box;
      margin:0;
      padding:0;
      outline:none;
      font-family:"Fira Code",monospace;
    }

    html,body{
      width:100%;
      height:100%;
      background-color:var(--bg-root);
      color:var(--text-main);
    }

    body{
      display:flex;
      flex-direction:column;
      padding:16px;
      gap:12px;
      overflow:hidden; /* scroll di workspace, bukan body */
    }

    /* ============ GENERIC ============ */
    .card{
      background:var(--bg-main);
      border:1px solid var(--border-soft);
      border-radius:var(--card-radius);
      padding:var(--card-padding-v) var(--card-padding-h);
    }

    .title-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:8px;
    }

    .title-row h1{
      font-size:var(--fs-title);
      font-weight:600;
      letter-spacing:0.5px;
      color:var(--text-main);
    }

    .title-tag{
      font-size:var(--fs-small);
      color:var(--accent);
      opacity:0.9;
    }

    /* ============ TOOLBAR / HEADER ============ */
    .app-header{
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .toolbar-container{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
      font-size:var(--fs-small);
    }

    .toolbar-group{
      display:flex;
      gap:4px;
      padding-right:10px;
      border-right:1px solid var(--border-soft);
      align-items:center;
    }

    .toolbar-group:last-child{
      border-right:none;
      padding-right:0;
    }

    .tb-label{
      font-size:var(--fs-small);
      color:var(--text-muted);
      margin-right:4px;
    }

    .tb-btn{
      background:#141414;
      border:1px solid transparent;
      border-radius:3px;
      cursor:pointer;
      padding:4px 6px;
      font-size:var(--fs-small);
      color:var(--text-main);
      min-width:26px;
      display:flex;
      align-items:center;
      justify-content:center;
      transition:all 0.12s ease-out;
    }

    .tb-btn:hover{
      background:#181818;
      border-color:var(--border-soft);
    }

    .tb-btn:active,
    .tb-btn.active{
      background:#1f1f1f;
      border-color:var(--accent);
      color:var(--accent);
    }

    .tb-btn span{
      font-weight:600;
    }

    .tb-select{
      border:1px solid var(--border-soft);
      background:#141414;
      padding:4px 6px;
      border-radius:3px;
      font-size:var(--fs-small);
      color:var(--text-main);
      cursor:pointer;
      min-width:120px;
    }

    .tb-select:hover{
      border-color:var(--accent);
    }

    /* ============ WORKSPACE / EDITOR ============ */
    .workspace{
      flex:1 1 auto;
      overflow-y:auto;
      display:flex;
      justify-content:center;
      padding:0;
      scrollbar-width:thin;
      scrollbar-color:#333333 #000000;
    }

    .workspace::-webkit-scrollbar{
      width:6px;
    }
    .workspace::-webkit-scrollbar-thumb{
      background:#333333;
      border-radius:4px;
    }

    .paper-wrapper{
      width:100%;
      max-width:860px;
    }

    .paper{
      background:#0b0b0b;
      border:1px solid var(--border-soft);
      border-radius:var(--card-radius);
      padding:24px 28px;
      min-height:72vh;
      font-size:var(--fs-body);
      line-height:1.6;
      color:var(--text-main);
      white-space:pre-wrap;
    }

    .paper h1,
    .paper h2,
    .paper h3{
      margin-top:10px;
      margin-bottom:6px;
      font-weight:600;
      color:var(--accent);
    }
    .paper h1{ font-size:var(--fs-title); }
    .paper h2{ font-size:var(--fs-subtitle); }
    .paper h3{ font-size:var(--fs-body); }

    .paper p{
      margin-bottom:8px;
      color:var(--text-main);
    }

    .paper ul,
    .paper ol{
      margin-bottom:8px;
      padding-left:18px;
    }

    .paper blockquote{
      border-left:2px solid var(--accent);
      padding-left:10px;
      margin:8px 0;
      color:var(--text-muted);
      font-style:italic;
    }

    .paper hr{
      border:0;
      border-top:1px solid var(--border-soft);
      margin:12px 0;
    }

    /* ============ STATUS BAR ============ */
    .status-bar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:var(--fs-small);
      color:var(--text-muted);
      padding:6px 10px;
      background:#080808;
      border:1px solid var(--border-soft);
      border-radius:var(--card-radius);
    }

    .status-left,
    .status-right{
      display:flex;
      gap:10px;
      align-items:center;
    }

    .status-pill{
      padding:2px 6px;
      border-radius:999px;
      border:1px solid var(--border-soft);
      font-size:var(--fs-small);
    }

    .status-dot{
      width:6px;
      height:6px;
      border-radius:50%;
      background:#22c55e;
      margin-right:4px;
      display:inline-block;
    }

    /* ============ MOBILE ============ */
    @media (max-width:768px){
      body{
        padding:10px;
        gap:8px;
      }

      .toolbar-container{
        overflow-x:auto;
        padding-bottom:2px;
      }

      .toolbar-group{
        flex-shrink:0;
      }

      .paper{
        padding:16px 14px;
        min-height:65vh;
        font-size:10px;
      }

      .title-row h1{
        font-size:13px;
      }
    }
  </style>
</head>
<body>

  <!-- HEADER + TOOLBAR (CARD) -->
  <div class="card app-header">
    <div class="title-row">
      <h1>Doc Editor â€“ Kuantara Terminal</h1>
      <span class="title-tag">DOC MODE</span>
    </div>
    <div class="toolbar-container" id="toolbar">
      <div class="toolbar-group">
        <span class="tb-label">Style</span>
        <select id="font-style" class="tb-select" title="Style">
          <option value="p">Normal</option>
          <option value="h1">Heading 1</option>
          <option value="h2">Heading 2</option>
          <option value="h3">Heading 3</option>
          <option value="blockquote">Quote</option>
        </select>
      </div>

      <div class="toolbar-group">
        <span class="tb-label">Font</span>
        <select id="font-family" class="tb-select" title="Font">
          <option value="'Fira Code', monospace">Fira Code</option>
          <option value="'Courier New', monospace">Courier</option>
          <option value="'Consolas', monospace">Consolas</option>
        </select>
      </div>

      <div class="toolbar-group">
        <button class="tb-btn" data-cmd="bold" title="Bold (Ctrl+B)"><span>B</span></button>
        <button class="tb-btn" data-cmd="italic" title="Italic (Ctrl+I)"><span style="font-style:italic">I</span></button>
        <button class="tb-btn" data-cmd="underline" title="Underline (Ctrl+U)"><span style="text-decoration:underline">U</span></button>
        <button class="tb-btn" data-cmd="strikeThrough" title="Strikethrough"><span style="text-decoration:line-through">S</span></button>
      </div>

      <div class="toolbar-group">
        <button class="tb-btn" data-cmd="justifyLeft" title="Align Left">âŸ¸</button>
        <button class="tb-btn" data-cmd="justifyCenter" title="Center">â‰¡</button>
        <button class="tb-btn" data-cmd="justifyRight" title="Align Right">âŸ¹</button>
        <button class="tb-btn" data-cmd="insertUnorderedList" title="Bullet List">â€¢</button>
        <button class="tb-btn" data-cmd="insertOrderedList" title="Number List">1.</button>
      </div>

      <div class="toolbar-group" style="border-right:none;">
        <button class="tb-btn" data-cmd="undo" title="Undo">â†º</button>
        <button class="tb-btn" data-cmd="redo" title="Redo">â†»</button>
        <button class="tb-btn" id="btn-clean" title="New Document" style="color:#ff4b4b;">ðŸ—‘</button>
      </div>
    </div>
  </div>

  <!-- WORKSPACE -->
  <div class="workspace" id="workspace-area">
    <div class="paper-wrapper">
      <div id="editor" class="paper" contenteditable="true" spellcheck="false">
<h1>Laporan Market â€“ Kuantara</h1>
<p>Mulai tulis laporanmu di sini. Gunakan heading untuk setiap section (misalnya: Executive Summary, Global Macro, Cross-Asset, dll).</p>
      </div>
    </div>
  </div>

  <!-- STATUS BAR -->
  <div class="status-bar">
    <div class="status-left">
      <span class="status-pill" id="page-count">Page 1</span>
      <span id="word-count">0 words</span>
    </div>
    <div class="status-right">
      <span>
        <span class="status-dot"></span>
        <span id="save-status">Ready</span>
      </span>
    </div>
  </div>

  <script>
    (function(){
      const editor = document.getElementById("editor");
      const wordCountEl = document.getElementById("word-count");
      const saveStatusEl = document.getElementById("save-status");
      const fontStyleSel = document.getElementById("font-style");
      const fontFamilySel = document.getElementById("font-family");

      const STORAGE_KEY = "kuantara_doc_editor_dark_v1";
      let saveTimer = null;

      function execCmd(command, value = null) {
        document.execCommand(command, false, value);
        editor.focus();
        updateStats();
        triggerAutosave();
        updateToolbarState();
      }

      // Toolbar buttons
      document.querySelectorAll(".tb-btn[data-cmd]").forEach(btn => {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          execCmd(btn.dataset.cmd);
        });
      });

      // Dropdowns
      fontStyleSel.addEventListener("change", () => execCmd("formatBlock", fontStyleSel.value));
      fontFamilySel.addEventListener("change", () => execCmd("fontName", fontFamilySel.value));

      // New document
      document.getElementById("btn-clean").addEventListener("click", () => {
        if(confirm("Hapus semua isi dan mulai dokumen baru?")) {
          editor.innerHTML = "<h1>Laporan Market â€“ Kuantara</h1><p>Mulai tulis laporanmu di sini...</p>";
          updateStats();
          triggerAutosave();
        }
      });

      // Editor events
      editor.addEventListener("input", () => {
        updateStats();
        triggerAutosave();
      });

      editor.addEventListener("keyup", () => {
        updateToolbarState();
      });

      editor.addEventListener("click", () => {
        updateToolbarState();
      });

      // Paste as plain text
      editor.addEventListener("paste", (e) => {
        e.preventDefault();
        const text = (e.clipboardData || window.clipboardData).getData("text");
        document.execCommand("insertText", false, text);
      });

      function updateStats() {
        const text = editor.innerText || "";
        const words = text.trim().length ? text.trim().split(/\s+/).length : 0;
        wordCountEl.textContent = words + " words";
      }

      function updateToolbarState() {
        const cmds = ["bold", "italic", "underline", "justifyLeft", "justifyCenter", "justifyRight"];
        cmds.forEach(cmd => {
          const btn = document.querySelector(`.tb-btn[data-cmd="${cmd}"]`);
          if (!btn) return;
          if (document.queryCommandState(cmd)) {
            btn.classList.add("active");
          } else {
            btn.classList.remove("active");
          }
        });
      }

      function triggerAutosave() {
        saveStatusEl.textContent = "Saving...";
        if (saveTimer) clearTimeout(saveTimer);
        saveTimer = setTimeout(() => {
          try{
            localStorage.setItem(STORAGE_KEY, editor.innerHTML);
            saveStatusEl.textContent = "Saved (local)";
          }catch(err){
            saveStatusEl.textContent = "Save error";
          }
        }, 800);
      }

      function loadDoc() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
          editor.innerHTML = saved;
        }
        updateStats();
      }

      // Ctrl+S
      document.addEventListener("keydown", (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "s") {
          e.preventDefault();
          triggerAutosave();
        }
      });

      // Init
      loadDoc();
      updateToolbarState();
    })();
  </script>
</body>
</html>
