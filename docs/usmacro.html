<html lang="en"><head>
  <meta charset="UTF-8">
  <title>Kuantara Macro Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Fira Code -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&amp;display=swap">

  <!-- Chart.js for interactive charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --amber:#ffbf00;
      --bg-root:#000000;
      --bg-main:#111111;
      --border-soft:#2b2b2b;
      --text-main:#f5f5f5;
      --text-muted:#9b9b9b;
      --overlay:rgba(0,0,0,0.6);
      --danger:#ff4d4f;
      --ok:#46c97f;
      --warn:#ffc53d;
    }

    * {
      box-sizing:border-box;
      margin:0;
      padding:0;
      font-family:"Fira Code",monospace !important;
    }

    html, body {
      height:100%;
      width:100%;
    }

    body {
      background-color:var(--bg-root);
      color:var(--text-main);
      overflow:auto;
    }

    .kt-root {
      min-height:100vh;
      padding:16px;
      background:var(--bg-root);
      color:var(--text-main);
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .kt-header {
      display:flex;
      flex-wrap:wrap;
      justify-content:space-between;
      align-items:baseline;
      gap:8px;
    }

    .kt-title {
      font-size:14px;
      font-weight:700;
      letter-spacing:0.04em;
      text-transform:uppercase;
      color:var(--amber);
    }

    .kt-subtitle {
      font-size:10px;
      color:var(--text-muted);
    }

    .kt-status {
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:8px;
      font-size:9px;
      color:var(--text-muted);
    }

    .kt-pill {
      padding:2px 6px;
      border-radius:999px;
      border:1px solid var(--border-soft);
      font-size:9px;
    }

    .kt-pill-live {
      border-color:var(--amber);
      color:var(--amber);
    }

    .kt-dot {
      display:inline-block;
      width:6px;
      height:6px;
      border-radius:50%;
      background:var(--amber);
      margin-right:4px;
    }

    .kt-last-updated {
      font-size:9px;
      color:var(--text-muted);
    }

    /* KPI STRIP */
    .kt-kpi-strip {
      display:flex;
      flex-wrap:nowrap;
      overflow-x:auto;
      gap:8px;
      padding:4px 0;
    }

    .kt-kpi-card {
      flex:0 0 auto;
      min-width:150px;
      background:var(--bg-main);
      border:1px solid var(--border-soft);
      border-radius:4px;
      padding:8px 10px;
    }

    .kt-kpi-label {
      font-size:9px;
      color:var(--text-muted);
      margin-bottom:2px;
      white-space:nowrap;
    }

    .kt-kpi-value {
      font-size:12px;
      font-weight:500;
    }

    .kt-kpi-meta {
      font-size:9px;
      color:var(--text-muted);
      margin-top:2px;
    }

    .chip {
      display:inline-flex;
      align-items:center;
      gap:4px;
      padding:1px 6px;
      border-radius:999px;
      border:1px solid var(--border-soft);
      font-size:9px;
    }

    .chip-risk-on {
      border-color:var(--ok);
      color:var(--ok);
    }

    .chip-risk-off {
      border-color:var(--danger);
      color:var(--danger);
    }

    .chip-neutral {
      border-color:var(--warn);
      color:var(--warn);
    }

    /* GRID + CARDS */
    .kt-section-title {
      font-size:12px;
      font-weight:500;
      color:var(--text-main);
      margin-top:6px;
      margin-bottom:4px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .kt-section-title span {
      font-size:9px;
      color:var(--text-muted);
      font-weight:400;
    }

    .kt-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(240px, 1fr));
      gap:10px;
    }

    .kt-card {
      background:var(--bg-main);
      border:1px solid var(--border-soft);
      border-radius:4px;
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:6px;
      min-height:0;
    }

    .kt-card-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
    }

    .kt-card-title {
      font-size:11px;
      color:var(--text-main);
    }

    .kt-card-meta {
      font-size:9px;
      color:var(--text-muted);
    }

    .metric-list {
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    .metric-row {
      display:flex;
      justify-content:space-between;
      align-items:baseline;
      gap:6px;
    }

    .metric-label {
      font-size:9px;
      color:var(--text-muted);
      flex:1 1 auto;
      min-width:0;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .metric-value {
      font-size:10px;
      flex:0 0 auto;
      text-align:right;
    }

    .metric-value small {
      display:block;
      font-size:9px;
      color:var(--text-muted);
    }

    .metric-updated {
      animation:flash 0.5s ease-out;
    }

    @keyframes flash {
      0%   { background:rgba(255,191,0,0.18); }
      100% { background:transparent; }
    }

    .trend-tag {
      font-size:9px;
      padding:0 4px;
      border-radius:3px;
      border:1px solid var(--border-soft);
      margin-left:4px;
    }

    .trend-up    { border-color:var(--danger); color:var(--danger); }
    .trend-down  { border-color:var(--ok);     color:var(--ok); }
    .trend-flat  { border-color:var(--text-muted); color:var(--text-muted); }

    /* CHARTS */
    .chart-container {
      position:relative;
      width:100%;
      height:180px;
    }

    .chart-container canvas {
      width:100% !important;
      height:100% !important;
      display:block;
    }

    .hint {
      font-size:9px;
      color:var(--text-muted);
    }

    @media (max-width:768px) {
      .kt-header {
        flex-direction:column;
        align-items:flex-start;
      }
    }
  </style>
<style data-id="immersive-translate-input-injected-css">.immersive-translate-input {
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 2147483647;
  display: flex;
  justify-content: center;
  align-items: center;
}
.immersive-translate-attach-loading::after {
  content: " ";

  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;

  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-2000%, -50%);
  z-index: 100;
}

.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}

.immersive-translate-input-loading {
  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;
}

@keyframes immersiveTranslateShadowRolling {
  0% {
    box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  12% {
    box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  25% {
    box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  36% {
    box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color),
      100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
  }

  50% {
    box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color),
      110px 0 var(--loading-color), 100px 0 var(--loading-color);
  }

  62% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color),
      120px 0 var(--loading-color), 110px 0 var(--loading-color);
  }

  75% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      130px 0 var(--loading-color), 120px 0 var(--loading-color);
  }

  87% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
  }

  100% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
  }
}

.immersive-translate-toast {
  display: flex;
  position: fixed;
  z-index: 2147483647;
  left: 0;
  right: 0;
  top: 1%;
  width: fit-content;
  padding: 12px 20px;
  margin: auto;
  overflow: auto;
  background: #fef6f9;
  box-shadow: 0px 4px 10px 0px rgba(0, 10, 30, 0.06);
  font-size: 15px;
  border-radius: 8px;
  color: #333;
}

.immersive-translate-toast-content {
  display: flex;
  flex-direction: row;
  align-items: center;
}

.immersive-translate-toast-hidden {
  margin: 0 20px 0 72px;
  text-decoration: underline;
  cursor: pointer;
}

.immersive-translate-toast-close {
  color: #666666;
  font-size: 20px;
  font-weight: bold;
  padding: 0 10px;
  cursor: pointer;
}

@media screen and (max-width: 768px) {
  .immersive-translate-toast {
    top: 0;
    padding: 12px 0px 0 10px;
  }
  .immersive-translate-toast-content {
    flex-direction: column;
    text-align: center;
  }
  .immersive-translate-toast-hidden {
    margin: 10px auto;
  }
}

.immersive-translate-dialog {
  position: fixed;
  z-index: 2147483647;
  left: 0;
  top: 0;
  display: flex;
  width: 300px;
  flex-direction: column;
  align-items: center;
  font-size: 15px;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  margin: auto;
  height: fit-content;
  border-radius: 20px;
  background-color: #fff;
}

.immersive-translate-modal {
  display: none;
  position: fixed;
  z-index: 2147483647;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgb(0, 0, 0);
  background-color: rgba(0, 0, 0, 0.4);
  font-size: 15px;
}

.immersive-translate-modal-content {
  background-color: #fefefe;
  margin: 10% auto;
  padding: 40px 24px 24px;
  border-radius: 12px;
  width: 350px;
  font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
    "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
    "Segoe UI Symbol", "Noto Color Emoji";
  position: relative;
}

@media screen and (max-width: 768px) {
  .immersive-translate-modal-content {
    margin: 25% auto !important;
  }
}

@media screen and (max-width: 480px) {
  .immersive-translate-modal-content {
    width: 80vw !important;
    margin: 20vh auto !important;
    padding: 20px 12px 12px !important;
  }

  .immersive-translate-modal-title {
    font-size: 14px !important;
  }

  .immersive-translate-modal-body {
    font-size: 13px !important;
    max-height: 60vh !important;
  }

  .immersive-translate-btn {
    font-size: 13px !important;
    padding: 8px 16px !important;
    margin: 0 4px !important;
  }

  .immersive-translate-modal-footer {
    gap: 6px !important;
    margin-top: 16px !important;
  }
}

.immersive-translate-modal .immersive-translate-modal-content-in-input {
  max-width: 500px;
}
.immersive-translate-modal-content-in-input .immersive-translate-modal-body {
  text-align: left;
  max-height: unset;
}

.immersive-translate-modal-title {
  text-align: center;
  font-size: 16px;
  font-weight: 700;
  color: #333333;
}

.immersive-translate-modal-body {
  text-align: center;
  font-size: 14px;
  font-weight: 400;
  color: #333333;
  margin-top: 24px;
  word-break: break-all;
}

@media screen and (max-width: 768px) {
  .immersive-translate-modal-body {
    max-height: 250px;
    overflow-y: auto;
  }
}

.immersive-translate-close {
  color: #666666;
  position: absolute;
  right: 16px;
  top: 16px;
  font-size: 20px;
  font-weight: bold;
}

.immersive-translate-close:hover,
.immersive-translate-close:focus {
  text-decoration: none;
  cursor: pointer;
}

.immersive-translate-modal-footer {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  margin-top: 24px;
}

.immersive-translate-btn {
  width: fit-content;
  color: #fff;
  background-color: #ea4c89;
  border: none;
  font-size: 14px;
  margin: 0 8px;
  padding: 9px 30px;
  border-radius: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.immersive-translate-btn-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.immersive-translate-btn:hover {
  background-color: #f082ac;
}
.immersive-translate-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
.immersive-translate-btn:disabled:hover {
  background-color: #ea4c89;
}

.immersive-translate-link-btn {
  background-color: transparent;
  color: #ea4c89;
  border: none;
  cursor: pointer;
  height: 30px;
  line-height: 30px;
}

.immersive-translate-cancel-btn {
  /* gray color */
  background-color: rgb(89, 107, 120);
}

.immersive-translate-cancel-btn:hover {
  background-color: hsl(205, 20%, 32%);
}

.immersive-translate-action-btn {
  background-color: transparent;
  color: #ea4c89;
  border: 1px solid #ea4c89;
}

.immersive-translate-btn svg {
  margin-right: 5px;
}

.immersive-translate-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #ea4c89;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
}

.immersive-translate-primary-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #ea4c89;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
}

.immersive-translate-modal input[type="radio"] {
  margin: 0 6px;
  cursor: pointer;
}

.immersive-translate-modal label {
  cursor: pointer;
}

.immersive-translate-close-action {
  position: absolute;
  top: 2px;
  right: 0px;
  cursor: pointer;
}

.imt-image-status {
  background-color: rgba(0, 0, 0, 0.5) !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  border-radius: 16px !important;
}
.imt-image-status img,
.imt-image-status svg,
.imt-img-loading {
  width: 28px !important;
  height: 28px !important;
  margin: 0 0 8px 0 !important;
  min-height: 28px !important;
  min-width: 28px !important;
  position: relative !important;
}
.imt-img-loading {
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAtFBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////oK74hAAAAPHRSTlMABBMIDyQXHwyBfFdDMSw+OjXCb+5RG51IvV/k0rOqlGRM6KKMhdvNyZBz9MaupmxpWyj437iYd/yJVNZeuUC7AAACt0lEQVRIx53T2XKiUBCA4QYOiyCbiAsuuGBcYtxiYtT3f6/pbqoYHVFO5r+iivpo6DpAWYpqeoFfr9f90DsYAuRSWkFnPO50OgR9PwiCUFcl2GEcx+N/YBh6pvKaefHlUgZd1zVe0NbYcQjGBfzrPE8Xz8aF+71D8gG6DHFPpc4a7xFiCDuhaWgKgGIJQ3d5IMGDrpS4S5KgpIm+en9f6PlAhKby4JwEIxlYJV9h5k5nee9GoxHJ2IDSNB0dwdad1NAxDJ/uXDHYmebdk4PdbkS58CIVHdYSUHTYYRWOJblWSyu2lmy3KNFVJNBhxcuGW4YBVCbYGRZwIooipHsNqjM4FbgOQqQqSKQQU9V8xmi1QlgHqQQ6DDBvRUVCDirs+EzGDGOQTCATgtYTnbCVLgsVgRE0T1QE0qHCFAht2z6dLvJQs3Lo2FQoDxWNUiBhaP4eRgwNkI+dAjVOA/kUrIDwf3CG8NfNOE0eiFotSuo+rBiq8tD9oY4Qzc6YJw99hl1wzpQvD7ef2M8QgnOGJfJw+EltQc+oX2yn907QB22WZcvlUpd143dqQu+8pCJZuGE4xCuPXJqqcs5sNpsI93Rmzym1k4Npk+oD1SH3/a3LOK/JpUBpWfqNySxWzCfNCUITuDG5dtuphrUJ1myeIE9bIsPiKrfqTai5WZxbhtNphYx6GEIHihyGFTI69lje/rxajdh0s0msZ0zYxyPLhYCb1CyHm9Qsd2H37Y3lugVwL9kNh8Ot8cha6fUNQ8nuXi5z9/ExsAO4zQrb/ev1yrCB7lGyQzgYDGuxq1toDN/JGvN+HyWNHKB7zEoK+PX11e12G431erGYzwmytAWU56fkMHY5JJnDRR2eZji3AwtIcrEV8Cojat/BdQ7XOwGV1e1hDjGGjXbdArm8uJZtCH5MbcctVX8A1WpqumJHwckAAAAASUVORK5CYII=");
  background-size: 28px 28px;
  animation: image-loading-rotate 1s linear infinite !important;
}

.imt-image-status span {
  color: var(--bg-2, #fff) !important;
  font-size: 14px !important;
  line-height: 14px !important;
  font-weight: 500 !important;
  font-family: "PingFang SC", Arial, sans-serif !important;
}

.imt-primary-button {
  display: flex;
  padding: 12px 80px;
  justify-content: center;
  align-items: center;
  gap: 8px;
  border-radius: 8px;
  background: #ea4c89;
  color: #fff;
  font-size: 16px;
  font-style: normal;
  font-weight: 700;
  line-height: 24px;
  border: none;
  cursor: pointer;
}

.imt-retry-text {
  color: #999;
  text-align: center;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 21px;
  cursor: pointer;
}

.imt-action-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.imt-modal-content-text {
  text-align: left;
  color: #333;
  font-size: 16px;
  font-weight: 400;
  line-height: 24px;
}

@keyframes image-loading-rotate {
  from {
    transform: rotate(360deg);
  }
  to {
    transform: rotate(0deg);
  }
}

.imt-linear-gradient-text {
  background: linear-gradient(90deg, #00a6ff 0%, #c369ff 52.4%, #ff4590 100%);
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.imt-flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

.imt-linear-black-btn {
  border-radius: 50px;
  background: linear-gradient(66deg, #222 19%, #696969 94.25%);
  height: 48px;
  width: 100%;
  color: #fff;
  font-size: 16px;
  font-weight: 700;
  display: flex;
  align-items: center;
  cursor: pointer;
  justify-content: center;
}
</style></head>
<body>
  <div class="kt-root">
    <!-- HEADER -->
    

    <!-- TOP KPI STRIP -->
    <div class="kt-kpi-strip">
      <div class="kt-kpi-card">
        <div class="kt-kpi-label">Recession Probability (NY Fed)</div>
        <div class="kt-kpi-value" id="val-recession-prob">26.5%</div>
        <div class="kt-kpi-meta" id="val-recession-horizon">12m ahead • Oct 2026</div>
      </div>

      <div class="kt-kpi-card">
        <div class="kt-kpi-label">CPI Inflation YoY</div>
        <div class="kt-kpi-value" id="val-cpi-yoy">3.0%</div>
        <div class="kt-kpi-meta" id="val-cpi-period">Sep 2025</div>
      </div>

      <div class="kt-kpi-card">
        <div class="kt-kpi-label">Real GDP YoY</div>
        <div class="kt-kpi-value" id="val-gdp-yoy">4.6%</div>
        <div class="kt-kpi-meta" id="val-gdp-period">Q2 2025 • GDP/M2: <span id="val-gdp-m2">1.39</span></div>
      </div>

      <div class="kt-kpi-card">
        <div class="kt-kpi-label">Unemployment Rate</div>
        <div class="kt-kpi-value" id="val-unemp-rate">4.3%</div>
        <div class="kt-kpi-meta">Participation: <span id="val-participation-rate">62.3%</span></div>
      </div>

      <div class="kt-kpi-card">
        <div class="kt-kpi-label">Fed Funds (Upper Bound)</div>
        <div class="kt-kpi-value" id="val-ffr">5.50%</div>
        <div class="kt-kpi-meta">SOFR: <span id="val-sofr">5.32%</span></div>
      </div>

      <div class="kt-kpi-card">
        <div class="kt-kpi-label">Yield Curve Spread 10Y–3M</div>
        <div class="kt-kpi-value" id="val-spread-10y-3m">-95 bps</div>
        <div class="kt-kpi-meta">10Y–2Y: <span id="val-spread-10y-2y">-42 bps</span></div>
      </div>

      <div class="kt-kpi-card">
        <div class="kt-kpi-label">Macro Risk Regime</div>
        <div class="kt-kpi-value">
          <span class="chip chip-neutral" id="val-risk-regime">Late-Cycle • Fragile</span>
        </div>
        <div class="kt-kpi-meta">VVIX/VIX: <span id="val-vvix-vix">1.25</span></div>
      </div>
    </div>

    <!-- INTERACTIVE MACRO DASHBOARD (NOW AT TOP) -->
    <div class="kt-section-title">
      Interactive Macro Dashboard
      <span>Curves, liquidity &amp; risk – realtime</span>
    </div>
    <div class="kt-grid">
      <!-- Chart 1: Yield Curve Nominal vs Real -->
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Yield Curve • Nominal vs Real</div>
          <div class="kt-card-meta">1M–30Y • UST vs TIPS</div>
        </div>
        <div class="chart-container">
          <canvas id="chart-yield-curve" style="display: block; box-sizing: border-box; height: 180px; width: 309px;" width="463" height="270"></canvas>
        </div>
      </div>

      <!-- Chart 2: Net Liquidity vs S&P 500 -->
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Net Liquidity vs S&amp;P 500</div>
          <div class="kt-card-meta">Fed BS – TGA – RRP • Index</div>
        </div>
        <div class="chart-container">
          <canvas id="chart-net-liquidity" style="display: block; box-sizing: border-box; height: 180px; width: 309px;" width="463" height="270"></canvas>
        </div>
      </div>

      <!-- Chart 3: Recession Probability vs Unemployment -->
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Recession Probability vs Unemployment</div>
          <div class="kt-card-meta">Early warning vs labor slack</div>
        </div>
        <div class="chart-container">
          <canvas id="chart-recession-labor" style="display: block; box-sizing: border-box; height: 180px; width: 309px;" width="463" height="270"></canvas>
        </div>
      </div>

      <!-- Chart 4: Credit Spreads IG vs HY vs EM -->
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Credit Spreads • IG vs HY vs EM</div>
          <div class="kt-card-meta">OAS (bps)</div>
        </div>
        <div class="chart-container">
          <canvas id="chart-credit-spreads" style="display: block; box-sizing: border-box; height: 180px; width: 309px;" width="463" height="270"></canvas>
        </div>
      </div>
    </div>

    <!-- MACRO GROWTH & INFLATION -->
    <div class="kt-section-title">
      Macro Growth &amp; Inflation
      <span>Real economy &amp; prices</span>
    </div>
    <div class="kt-grid">
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Growth • GDP</div>
          <div class="kt-card-meta">Real activity</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Real GDP (SAAR)</div>
            <div class="metric-value" id="val-gdp-level">$30,486 bn</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Real GDP YoY</div>
            <div class="metric-value" id="val-gdp-yoy-row">
              <span id="val-gdp-yoy-2">4.6%</span>
            </div>
          </div>
          <div class="metric-row">
            <div class="metric-label">GDP / M2</div>
            <div class="metric-value" id="val-gdp-m2-row">
              <span id="val-gdp-m2-2">1.39</span>
            </div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Capacity Utilisation</div>
            <div class="metric-value" id="val-capacity-util">77.4%</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Inflation • CPI &amp; PPI</div>
          <div class="kt-card-meta">Prices &amp; pipelines</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">CPI YoY</div>
            <div class="metric-value" id="val-cpi-yoy-row">
              <span id="val-cpi-yoy-2">3.0%</span>
            </div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Core CPI YoY</div>
            <div class="metric-value" id="val-core-cpi-yoy">—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">PCE Core YoY</div>
            <div class="metric-value" id="val-pce-core-yoy">—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">PPI All Commodities YoY</div>
            <div class="metric-value" id="val-ppi-commod-yoy">2.7%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">PPI Final Demand YoY</div>
            <div class="metric-value" id="val-ppi-yoy">2.6%</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Supply Chain &amp; Savings</div>
          <div class="kt-card-meta">Buffers &amp; bottlenecks</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Global Supply Chain Pressure Index</div>
            <div class="metric-value" id="val-gscpi">—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Personal Saving Rate</div>
            <div class="metric-value" id="val-saving-rate">—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Real Wage Growth YoY</div>
            <div class="metric-value" id="val-real-wage-yoy">—</div>
          </div>
        </div>
      </div>
    </div>

    <!-- LABOR MARKET -->
    <div class="kt-section-title">
      Labor Market
      <span>Jobs, wages &amp; flows</span>
    </div>
    <div class="kt-grid">
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Headline Labor</div>
          <div class="kt-card-meta">Unemployment &amp; payrolls</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Unemployment Rate</div>
            <div class="metric-value" id="val-unemp-rate-2">4.3%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Participation Rate</div>
            <div class="metric-value" id="val-participation-rate-2">62.3%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Nonfarm Payroll Change</div>
            <div class="metric-value" id="val-payroll-change">+XXX k</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Initial Claims (Weekly)</div>
            <div class="metric-value" id="val-initial-claims">
              218,000
              <small>4W avg: <span id="val-initial-claims-4w">237,500</span></small>
            </div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">JOLTS • Labor Flows</div>
          <div class="kt-card-meta">Demand vs quits</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Job Openings</div>
            <div class="metric-value" id="val-jolts-openings">7,227 k</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Hires</div>
            <div class="metric-value" id="val-jolts-hires">5,126 k</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Quits</div>
            <div class="metric-value" id="val-jolts-quits">—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Layoffs &amp; Discharges</div>
            <div class="metric-value" id="val-jolts-layoffs">—</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Wages • AHE</div>
          <div class="kt-card-meta">Price of labor</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Average Hourly Earnings (Level)</div>
            <div class="metric-value" id="val-ahe-level">$—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Average Hourly Earnings YoY</div>
            <div class="metric-value" id="val-ahe-yoy">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">AHE Services YoY</div>
            <div class="metric-value" id="val-ahe-services-yoy">—%</div>
          </div>
        </div>
      </div>
    </div>

    <!-- SENTIMENT & BUSINESS -->
    <div class="kt-section-title">
      Sentiment &amp; Business Cycle
      <span>Consumers, firms &amp; housing</span>
    </div>
    <div class="kt-grid">
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Sentiment &amp; Surveys</div>
          <div class="kt-card-meta">Soft data</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Consumer Sentiment (U. Mich)</div>
            <div class="metric-value" id="val-cons-sentiment">55.1</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">ISM Manufacturing PMI</div>
            <div class="metric-value" id="val-ism-mfg">—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">ISM New Orders</div>
            <div class="metric-value" id="val-ism-new-orders">—</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Housing &amp; Mortgage</div>
          <div class="kt-card-meta">Rates &amp; spreads</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">30Y Mortgage Rate</div>
            <div class="metric-value" id="val-mortgage-rate">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Mortgage Spread vs 10Y UST</div>
            <div class="metric-value" id="val-mortgage-spread">— bps</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Housing Affordability Index</div>
            <div class="metric-value" id="val-housing-afford">—</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Market Internals</div>
          <div class="kt-card-meta">Breadth &amp; positioning</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">% Stocks Outperform S&amp;P 500 (1Y)</div>
            <div class="metric-value" id="val-breadth-outperform">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">% Above 50D MA</div>
            <div class="metric-value" id="val-breadth-ma50">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">% Above 200D MA</div>
            <div class="metric-value" id="val-breadth-ma200">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">NAAIM Exposure Index</div>
            <div class="metric-value" id="val-naaim">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">S&amp;P 500 / Gold Ratio</div>
            <div class="metric-value" id="val-spx-gold">—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Short Interest (Equity)</div>
            <div class="metric-value" id="val-short-interest">—%</div>
          </div>
        </div>
      </div>
    </div>

    <!-- OPTIONS & VOL -->
    <div class="kt-section-title">
      Volatility &amp; Options
      <span>Risk pricing</span>
    </div>
    <div class="kt-grid">
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Volatility Structure</div>
          <div class="kt-card-meta">Implied vs tail</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">VVIX / VIX Ratio</div>
            <div class="metric-value" id="val-vvix-vix-2">1.25</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">VIX (30D Implied)</div>
            <div class="metric-value" id="val-vix">—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">MOVE (Treasury Vol)</div>
            <div class="metric-value" id="val-move">—</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Options Pricing • 1Y ATM</div>
          <div class="kt-card-meta">S&amp;P 500 &amp; Gold</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">S&amp;P 500 1Y ATM Put Price</div>
            <div class="metric-value" id="val-opt-spx-put">$—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">S&amp;P 500 1Y ATM Call Price</div>
            <div class="metric-value" id="val-opt-spx-call">$—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Gold 1Y ATM Put Price</div>
            <div class="metric-value" id="val-opt-gold-put">$—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Gold 1Y ATM Call Price</div>
            <div class="metric-value" id="val-opt-gold-call">$—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Market Put/Call Ratio</div>
            <div class="metric-value" id="val-putcall-ratio">—</div>
          </div>
        </div>
      </div>
    </div>

    <!-- MONETARY & LIQUIDITY -->
    <div class="kt-section-title">
      Monetary Base &amp; Liquidity
      <span>M2, Fed balance sheet &amp; dollar</span>
    </div>
    <div class="kt-grid">
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Money Supply • M2</div>
          <div class="kt-card-meta">Quantity of money</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">M2 Level</div>
            <div class="metric-value" id="val-m2-level">$— tn</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">M2 YoY</div>
            <div class="metric-value" id="val-m2-yoy">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">M2 MoM (Annualised)</div>
            <div class="metric-value" id="val-m2-mom">—%</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Fed Balance Sheet</div>
          <div class="kt-card-meta">Liquidity plumbing</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Total Assets</div>
            <div class="metric-value" id="val-fed-assets">$— tn</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Treasury General Account (TGA)</div>
            <div class="metric-value" id="val-fed-tga">$— bn</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Reverse Repo Facility (RRP)</div>
            <div class="metric-value" id="val-fed-rrp">$— bn</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Net Liquidity (Fed BS – TGA – RRP)</div>
            <div class="metric-value" id="val-fed-net-liq">$— tn</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Purchasing Power of the Dollar</div>
          <div class="kt-card-meta">Real value vs history</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">CPI-Adjusted Dollar (Index)</div>
            <div class="metric-value" id="val-dollar-pp-index">—</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Real Effective Exchange Rate</div>
            <div class="metric-value" id="val-dollar-reer">—</div>
          </div>
        </div>
      </div>
    </div>

    <!-- FISCAL & DEBT -->
    <div class="kt-section-title">
      Fiscal &amp; Public Debt
      <span>Solvency &amp; flow</span>
    </div>
    <div class="kt-grid">
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Public Debt • Levels</div>
          <div class="kt-card-meta">Stocks &amp; ratios</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Total Public Debt</div>
            <div class="metric-value" id="val-debt-total">$— tn</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Debt / GDP</div>
            <div class="metric-value" id="val-debt-gdp">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Debt / M2</div>
            <div class="metric-value" id="val-debt-m2">—x</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Foreign-Held Debt</div>
            <div class="metric-value" id="val-debt-foreign">$— tn</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Interest Burden</div>
          <div class="kt-card-meta">Cost of debt</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Interest Payments (Annualised)</div>
            <div class="metric-value" id="val-debt-interest-payments">$— bn</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Effective Interest Rate on Debt</div>
            <div class="metric-value" id="val-debt-effective-rate">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Interest Payments / Tax Revenue</div>
            <div class="metric-value" id="val-interest-tax-ratio">—%</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Budget Balance</div>
          <div class="kt-card-meta">Flow deficit</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Federal Budget Balance (Monthly)</div>
            <div class="metric-value" id="val-budget-monthly">$— bn</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Federal Budget Balance (TTM)</div>
            <div class="metric-value" id="val-budget-yearly">$— bn</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Deficit / GDP</div>
            <div class="metric-value" id="val-deficit-gdp">—%</div>
          </div>
        </div>
      </div>
    </div>

    <!-- CREDIT RISK -->
    <div class="kt-section-title">
      Credit Risk &amp; Delinquency
      <span>Households &amp; corporates</span>
    </div>
    <div class="kt-grid">
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Consumer Credit Stress</div>
          <div class="kt-card-meta">Household side</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Consumer Loan Delinquency Rate</div>
            <div class="metric-value" id="val-delinquency-consumer">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Credit Card Delinquency Rate</div>
            <div class="metric-value" id="val-delinquency-cc">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Credit Card Delinq. (Banks outside Top 100)</div>
            <div class="metric-value" id="val-delinquency-cc-small">—%</div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">Business Credit Stress</div>
          <div class="kt-card-meta">Firms &amp; defaults</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">Commercial &amp; Industrial Loan Delinq.</div>
            <div class="metric-value" id="val-delinquency-business">—%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">Bankruptcy Filings (12M)</div>
            <div class="metric-value" id="val-bankruptcy-filings">—</div>
          </div>
        </div>
      </div>
    </div>

    <!-- CORPORATE & EM CREDIT -->
    <div class="kt-section-title">
      Corporate &amp; EM Bonds
      <span>Spreads &amp; risk premium</span>
    </div>
    <div class="kt-grid">
      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">US Corporates • Investment Grade</div>
          <div class="kt-card-meta">AAA–BBB • Yield / OAS</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">AAA Yield / OAS</div>
            <div class="metric-value" id="val-ig-aaa">
              <span id="val-ig-aaa-yield">—%</span> / <span id="val-ig-aaa-oas">— bps</span>
            </div>
          </div>
          <div class="metric-row">
            <div class="metric-label">AA Yield / OAS</div>
            <div class="metric-value" id="val-ig-aa">
              <span id="val-ig-aa-yield">—%</span> / <span id="val-ig-aa-oas">— bps</span>
            </div>
          </div>
          <div class="metric-row">
            <div class="metric-label">A Yield / OAS</div>
            <div class="metric-value" id="val-ig-a">
              <span id="val-ig-a-yield">—%</span> / <span id="val-ig-a-oas">— bps</span>
            </div>
          </div>
          <div class="metric-row">
            <div class="metric-label">BBB Yield / OAS</div>
            <div class="metric-value" id="val-ig-bbb">
              <span id="val-ig-bbb-yield">—%</span> / <span id="val-ig-bbb-oas">— bps</span>
            </div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">US High Yield</div>
          <div class="kt-card-meta">BB–CCC • Yield / OAS</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">BB Yield / OAS</div>
            <div class="metric-value" id="val-hy-bb">
              <span id="val-hy-bb-yield">—%</span> / <span id="val-hy-bb-oas">— bps</span>
            </div>
          </div>
          <div class="metric-row">
            <div class="metric-label">B Yield / OAS</div>
            <div class="metric-value" id="val-hy-b">
              <span id="val-hy-b-yield">—%</span> / <span id="val-hy-b-oas">— bps</span>
            </div>
          </div>
          <div class="metric-row">
            <div class="metric-label">CCC Yield / OAS</div>
            <div class="metric-value" id="val-hy-ccc">
              <span id="val-hy-ccc-yield">—%</span> / <span id="val-hy-ccc-oas">— bps</span>
            </div>
          </div>
        </div>
      </div>

      <div class="kt-card">
        <div class="kt-card-header">
          <div class="kt-card-title">EM Sovereign • USD</div>
          <div class="kt-card-meta">High Grade &amp; High Yield</div>
        </div>
        <div class="metric-list">
          <div class="metric-row">
            <div class="metric-label">EM High Grade Yield / OAS</div>
            <div class="metric-value" id="val-em-hg">
              <span id="val-em-hg-yield">—%</span> / <span id="val-em-hg-oas">— bps</span>
            </div>
          </div>
          <div class="metric-row">
            <div class="metric-label">EM High Yield Yield / OAS</div>
            <div class="metric-value" id="val-em-hy">
              <span id="val-em-hy-yield">—%</span> / <span id="val-em-hy-oas">— bps</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="hint">
      Hint: backend cukup kirim JSON ke WebSocket/API dengan key = ID elemen (mis. <code>val-cpi-yoy</code>)
      dan/atau <code>charts[chartId]</code>, lalu panggil <code>window.KuantaraMacroUpdate(payload)</code>.
    </div>
  </div>

  <script>
    // ===== Metric helpers =====
    function setMetricValue(id, value) {
      var el = document.getElementById(id);
      if (!el) return;
      el.textContent = value;
      el.classList.remove('metric-updated');
      void el.offsetWidth; // restart animation
      el.classList.add('metric-updated');
    }

    // ===== Chart init =====
    window.KuantaraCharts = {};

    function createChartYields(ctx) {
      return new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['1M','3M','6M','1Y','2Y','3Y','5Y','7Y','10Y','30Y'],
          datasets: [
            {
              label: 'Nominal UST',
              data: [5.3,5.4,5.2,5.0,4.8,4.6,4.3,4.2,4.1,4.0],
              borderWidth:1,
              tension:0.25
            },
            {
              label: 'Real TIPS',
              data: [0.0,0.0,0.0,1.6,1.7,1.8,1.9,2.0,2.0,2.0],
              borderWidth:1,
              borderDash:[4,3],
              tension:0.25
            }
          ]
        },
        options: {
          responsive:true,
          maintainAspectRatio:false,
          interaction:{mode:'index', intersect:false},
          plugins:{
            legend:{labels:{font:{size:9}, color:'#f5f5f5'}},
            tooltip:{titleFont:{size:10}, bodyFont:{size:9}}
          },
          scales:{
            x:{ticks:{font:{size:9}, color:'#9b9b9b'}, grid:{color:'#2b2b2b'}},
            y:{ticks:{font:{size:9}, color:'#9b9b9b'}, grid:{color:'#2b2b2b'}}
          }
        }
      });
    }

    function createChartNetLiquidity(ctx) {
      return new Chart(ctx, {
        type: 'line',
        data: {
          labels: [],
          datasets: [
            {
              label:'Net Liquidity (tn)',
              data:[],
              borderWidth:1,
              yAxisID:'y',
              tension:0.15
            },
            {
              label:'S&P 500 (index)',
              data:[],
              borderWidth:1,
              borderDash:[4,3],
              yAxisID:'y1',
              tension:0.15
            }
          ]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          interaction:{mode:'index', intersect:false},
          plugins:{
            legend:{labels:{font:{size:9}, color:'#f5f5f5'}},
            tooltip:{titleFont:{size:10}, bodyFont:{size:9}}
          },
          scales:{
            x:{ticks:{font:{size:9}, color:'#9b9b9b'}, grid:{color:'#2b2b2b'}},
            y:{
              position:'left',
              ticks:{font:{size:9}, color:'#9b9b9b'},
              grid:{color:'#2b2b2b'}
            },
            y1:{
              position:'right',
              ticks:{font:{size:9}, color:'#9b9b9b'},
              grid:{drawOnChartArea:false}
            }
          }
        }
      });
    }

    function createChartRecessionLabor(ctx) {
      return new Chart(ctx, {
        type:'line',
        data:{
          labels:[],
          datasets:[
            {
              label:'Recession Probability (%)',
              data:[],
              borderWidth:1,
              yAxisID:'y',
              tension:0.15
            },
            {
              label:'Unemployment Rate (%)',
              data:[],
              borderWidth:1,
              borderDash:[4,3],
              yAxisID:'y1',
              tension:0.15
            }
          ]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          interaction:{mode:'index', intersect:false},
          plugins:{
            legend:{labels:{font:{size:9}, color:'#f5f5f5'}},
            tooltip:{titleFont:{size:10}, bodyFont:{size:9}}
          },
          scales:{
            x:{ticks:{font:{size:9}, color:'#9b9b9b'}, grid:{color:'#2b2b2b'}},
            y:{
              position:'left',
              ticks:{font:{size:9}, color:'#9b9b9b'},
              grid:{color:'#2b2b2b'}
            },
            y1:{
              position:'right',
              ticks:{font:{size:9}, color:'#9b9b9b'},
              grid:{drawOnChartArea:false}
            }
          }
        }
      });
    }

    function createChartCreditSpreads(ctx) {
      return new Chart(ctx, {
        type:'line',
        data:{
          labels:[],
          datasets:[
            {
              label:'US IG OAS (bps)',
              data:[],
              borderWidth:1,
              tension:0.15
            },
            {
              label:'US HY OAS (bps)',
              data:[],
              borderWidth:1,
              borderDash:[4,3],
              tension:0.15
            },
            {
              label:'EM USD OAS (bps)',
              data:[],
              borderWidth:1,
              borderDash:[2,2],
              tension:0.15
            }
          ]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          interaction:{mode:'index', intersect:false},
          plugins:{
            legend:{labels:{font:{size:9}, color:'#f5f5f5'}},
            tooltip:{titleFont:{size:10}, bodyFont:{size:9}}
          },
          scales:{
            x:{ticks:{font:{size:9}, color:'#9b9b9b'}, grid:{color:'#2b2b2b'}},
            y:{ticks:{font:{size:9}, color:'#9b9b9b'}, grid:{color:'#2b2b2b'}}
          }
        }
      });
    }

    function initCharts() {
      var c1 = document.getElementById('chart-yield-curve');
      var c2 = document.getElementById('chart-net-liquidity');
      var c3 = document.getElementById('chart-recession-labor');
      var c4 = document.getElementById('chart-credit-spreads');
      if (c1) window.KuantaraCharts['chart-yield-curve'] = createChartYields(c1.getContext('2d'));
      if (c2) window.KuantaraCharts['chart-net-liquidity'] = createChartNetLiquidity(c2.getContext('2d'));
      if (c3) window.KuantaraCharts['chart-recession-labor'] = createChartRecessionLabor(c3.getContext('2d'));
      if (c4) window.KuantaraCharts['chart-credit-spreads'] = createChartCreditSpreads(c4.getContext('2d'));
    }

    function updateChartFromPayload(id, cfg) {
      var chart = window.KuantaraCharts[id];
      if (!chart || !cfg) return;
      if (Array.isArray(cfg.labels)) {
        chart.data.labels = cfg.labels;
      }
      if (Array.isArray(cfg.datasets)) {
        cfg.datasets.forEach(function(dsCfg, idx){
          var ds = chart.data.datasets[idx];
          if (!ds || !dsCfg) return;
          if (Array.isArray(dsCfg.data)) ds.data = dsCfg.data;
          if (typeof dsCfg.label === 'string') ds.label = dsCfg.label;
        });
      }
      chart.update('none');
    }

    // ===== Public updater =====
    window.KuantaraMacroUpdate = function (data) {
      if (!data || typeof data !== 'object') return;

      // metrics: flat or under data.metrics
      var metricSource = data.metrics || data;
      Object.keys(metricSource).forEach(function (id) {
        if (id === 'last_updated' || id === 'charts' || id === 'metrics') return;
        setMetricValue(id, metricSource[id]);
      });

      // charts: data.charts[chartId] = { labels:[], datasets:[{data:[]}, ...] }
      if (data.charts && typeof data.charts === 'object') {
        Object.keys(data.charts).forEach(function(chartId){
          updateChartFromPayload(chartId, data.charts[chartId]);
        });
      }

      // last updated
      if (data.last_updated) {
        var lu = document.getElementById('last-updated');
        if (lu) lu.textContent = data.last_updated;
      }
    };

    // ===== WebSocket example =====
    (function initWebSocket() {
      var wsUrl = window.KuantaraMacroWsUrl || 'wss://your-macro-stream';
      try {
        var socket = new WebSocket(wsUrl);
        socket.onopen = function () {
          // socket.send(JSON.stringify({type:'subscribe', channel:'us_macro_dashboard'}));
        };
        socket.onmessage = function (event) {
          try {
            var payload = JSON.parse(event.data);
            window.KuantaraMacroUpdate(payload);
          } catch (e) {
            console.error('Macro WS parse error:', e);
          }
        };
        socket.onerror = function (e) {
          console.warn('Macro WS error:', e);
        };
      } catch (err) {
        console.warn('Macro WS init failed:', err);
      }
    })();

    document.addEventListener('DOMContentLoaded', initCharts);

    (function initTimestamp() {
      var lu = document.getElementById('last-updated');
      if (!lu) return;
      var now = new Date();
      lu.textContent = now.toISOString();
    })();
  </script>


</body><chatgpt-sidebar data-gpts-theme="light"></chatgpt-sidebar><div id="immersive-translate-browser-popup" style="all: initial"></div></html>
