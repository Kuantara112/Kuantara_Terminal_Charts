<html lang="en"><head>
  <meta charset="UTF-8">
  <title>Kuantara Technical Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Fira Code -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&amp;display=swap">

  <!-- Chart.js (untuk grafik harga & pattern) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --amber:#ffbf00;
      --bg-root:#000000;
      --bg-main:#111111;
      --border-soft:#2b2b2b;
      --text-main:#f5f5f5;
      --text-muted:#9b9b9b;
    }

    * {
      box-sizing:border-box;
      margin:0;
      padding:0;
      font-family:"Fira Code",monospace!important;
    }

    html,body { height:100%; }
    body {
      background-color:var(--bg-root);
      color:var(--text-main);
      overflow:hidden;
    }

    .kt-root {
      height:100vh;
      padding:16px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .page-title {
      font-size:14px;
      font-weight:600;
      color:var(--amber);
      letter-spacing:0.03em;
    }

    .page-subtitle {
      font-size:10px;
      color:var(--text-muted);
    }

    .grid-2x2 {
      flex:1;
      display:grid;
      grid-template-columns:1fr 1fr;
      grid-template-rows:1fr 1fr;
      gap:12px;
      min-height:0;
      min-width:0;
    }

    .card {
      background-color:var(--bg-main);
      border:1px solid var(--border-soft);
      border-radius:4px;
      padding:12px 16px;
      display:flex;
      flex-direction:column;
      gap:8px;
      min-width:0;
      min-height:0;
    }

    .card-title {
      font-size:12px;
      font-weight:500;
      color:var(--text-main);
    }

    .card-subtitle {
      font-size:9px;
      color:var(--text-muted);
    }

    .controls-grid {
      display:grid;
      grid-template-columns:repeat(2, minmax(0,1fr));
      gap:8px;
      margin-top:6px;
    }

    .control-group {
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    label {
      font-size:10px;
      color:var(--text-muted);
    }

    select {
      background:#000000;
      color:var(--text-main);
      border:1px solid var(--border-soft);
      border-radius:4px;
      padding:4px 6px;
      font-size:10px;
      outline:none;
    }

    select:focus {
      border-color:var(--amber);
    }

    .controls-footer {
      margin-top:8px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      font-size:9px;
      color:var(--text-muted);
    }

    .btn-apply {
      background-color:var(--amber);
      color:#000000;
      border:none;
      border-radius:4px;
      padding:4px 10px;
      font-size:10px;
      cursor:pointer;
    }

    .btn-apply:hover {
      filter:brightness(1.05);
    }

    .chart-wrapper {
      flex:1;
      min-height:0;
      position:relative;
    }

    canvas {
      width:100%!important;
      height:100%!important;
      border:none;
    }

    .legend {
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      font-size:9px;
      color:var(--text-muted);
    }

    .legend span {
      white-space:nowrap;
    }

    .summary-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }

    .rating-pill {
      font-size:11px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid var(--amber);
      color:var(--amber);
    }

    .summary-table {
      width:100%;
      border-collapse:collapse;
      font-size:9px;
      margin-top:6px;
    }

    .summary-table th,
    .summary-table td {
      border:1px solid var(--border-soft);
      padding:4px 6px;
      text-align:center;
      white-space:nowrap;
    }

    .summary-table th {
      background-color:#000000;
      color:var(--text-muted);
      font-weight:400;
    }

    .summary-table td.signal-buy { color:#4caf50; }
    .summary-table td.signal-sell { color:#f44336; }
    .summary-table td.signal-neutral { color:var(--text-muted); }

    .pattern-list {
      font-size:9px;
      color:var(--text-muted);
      display:flex;
      flex-wrap:wrap;
      gap:6px 10px;
    }

    .pattern-tag {
      border:1px solid var(--border-soft);
      border-radius:3px;
      padding:2px 6px;
    }

    .pattern-tag.active {
      border-color:var(--amber);
      color:var(--amber);
    }

    .meta-line {
      font-size:9px;
      color:var(--text-muted);
      margin-top:4px;
    }

    @media (max-width:900px) {
      body { overflow:auto; }
      .kt-root { height:auto; }
      .grid-2x2 {
        grid-template-columns:1fr;
        grid-template-rows:auto;
      }
    }
  </style>
<style data-id="immersive-translate-input-injected-css">.immersive-translate-input {
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 2147483647;
  display: flex;
  justify-content: center;
  align-items: center;
}
.immersive-translate-attach-loading::after {
  content: " ";

  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;

  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-2000%, -50%);
  z-index: 100;
}

.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}

.immersive-translate-input-loading {
  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;
}

@keyframes immersiveTranslateShadowRolling {
  0% {
    box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  12% {
    box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  25% {
    box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  36% {
    box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color),
      100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
  }

  50% {
    box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color),
      110px 0 var(--loading-color), 100px 0 var(--loading-color);
  }

  62% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color),
      120px 0 var(--loading-color), 110px 0 var(--loading-color);
  }

  75% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      130px 0 var(--loading-color), 120px 0 var(--loading-color);
  }

  87% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
  }

  100% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
  }
}

.immersive-translate-toast {
  display: flex;
  position: fixed;
  z-index: 2147483647;
  left: 0;
  right: 0;
  top: 1%;
  width: fit-content;
  padding: 12px 20px;
  margin: auto;
  overflow: auto;
  background: #fef6f9;
  box-shadow: 0px 4px 10px 0px rgba(0, 10, 30, 0.06);
  font-size: 15px;
  border-radius: 8px;
  color: #333;
}

.immersive-translate-toast-content {
  display: flex;
  flex-direction: row;
  align-items: center;
}

.immersive-translate-toast-hidden {
  margin: 0 20px 0 72px;
  text-decoration: underline;
  cursor: pointer;
}

.immersive-translate-toast-close {
  color: #666666;
  font-size: 20px;
  font-weight: bold;
  padding: 0 10px;
  cursor: pointer;
}

@media screen and (max-width: 768px) {
  .immersive-translate-toast {
    top: 0;
    padding: 12px 0px 0 10px;
  }
  .immersive-translate-toast-content {
    flex-direction: column;
    text-align: center;
  }
  .immersive-translate-toast-hidden {
    margin: 10px auto;
  }
}

.immersive-translate-dialog {
  position: fixed;
  z-index: 2147483647;
  left: 0;
  top: 0;
  display: flex;
  width: 300px;
  flex-direction: column;
  align-items: center;
  font-size: 15px;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  margin: auto;
  height: fit-content;
  border-radius: 20px;
  background-color: #fff;
}

.immersive-translate-modal {
  display: none;
  position: fixed;
  z-index: 2147483647;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgb(0, 0, 0);
  background-color: rgba(0, 0, 0, 0.4);
  font-size: 15px;
}

.immersive-translate-modal-content {
  background-color: #fefefe;
  margin: 10% auto;
  padding: 40px 24px 24px;
  border-radius: 12px;
  width: 350px;
  font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
    "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
    "Segoe UI Symbol", "Noto Color Emoji";
  position: relative;
}

@media screen and (max-width: 768px) {
  .immersive-translate-modal-content {
    margin: 25% auto !important;
  }
}

@media screen and (max-width: 480px) {
  .immersive-translate-modal-content {
    width: 80vw !important;
    margin: 20vh auto !important;
    padding: 20px 12px 12px !important;
  }

  .immersive-translate-modal-title {
    font-size: 14px !important;
  }

  .immersive-translate-modal-body {
    font-size: 13px !important;
    max-height: 60vh !important;
  }

  .immersive-translate-btn {
    font-size: 13px !important;
    padding: 8px 16px !important;
    margin: 0 4px !important;
  }

  .immersive-translate-modal-footer {
    gap: 6px !important;
    margin-top: 16px !important;
  }
}

.immersive-translate-modal .immersive-translate-modal-content-in-input {
  max-width: 500px;
}
.immersive-translate-modal-content-in-input .immersive-translate-modal-body {
  text-align: left;
  max-height: unset;
}

.immersive-translate-modal-title {
  text-align: center;
  font-size: 16px;
  font-weight: 700;
  color: #333333;
}

.immersive-translate-modal-body {
  text-align: center;
  font-size: 14px;
  font-weight: 400;
  color: #333333;
  margin-top: 24px;
  word-break: break-all;
}

@media screen and (max-width: 768px) {
  .immersive-translate-modal-body {
    max-height: 250px;
    overflow-y: auto;
  }
}

.immersive-translate-close {
  color: #666666;
  position: absolute;
  right: 16px;
  top: 16px;
  font-size: 20px;
  font-weight: bold;
}

.immersive-translate-close:hover,
.immersive-translate-close:focus {
  text-decoration: none;
  cursor: pointer;
}

.immersive-translate-modal-footer {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  margin-top: 24px;
}

.immersive-translate-btn {
  width: fit-content;
  color: #fff;
  background-color: #ea4c89;
  border: none;
  font-size: 14px;
  margin: 0 8px;
  padding: 9px 30px;
  border-radius: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.immersive-translate-btn-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.immersive-translate-btn:hover {
  background-color: #f082ac;
}
.immersive-translate-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
.immersive-translate-btn:disabled:hover {
  background-color: #ea4c89;
}

.immersive-translate-link-btn {
  background-color: transparent;
  color: #ea4c89;
  border: none;
  cursor: pointer;
  height: 30px;
  line-height: 30px;
}

.immersive-translate-cancel-btn {
  /* gray color */
  background-color: rgb(89, 107, 120);
}

.immersive-translate-cancel-btn:hover {
  background-color: hsl(205, 20%, 32%);
}

.immersive-translate-action-btn {
  background-color: transparent;
  color: #ea4c89;
  border: 1px solid #ea4c89;
}

.immersive-translate-btn svg {
  margin-right: 5px;
}

.immersive-translate-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #ea4c89;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
}

.immersive-translate-primary-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #ea4c89;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
}

.immersive-translate-modal input[type="radio"] {
  margin: 0 6px;
  cursor: pointer;
}

.immersive-translate-modal label {
  cursor: pointer;
}

.immersive-translate-close-action {
  position: absolute;
  top: 2px;
  right: 0px;
  cursor: pointer;
}

.imt-image-status {
  background-color: rgba(0, 0, 0, 0.5) !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  border-radius: 16px !important;
}
.imt-image-status img,
.imt-image-status svg,
.imt-img-loading {
  width: 28px !important;
  height: 28px !important;
  margin: 0 0 8px 0 !important;
  min-height: 28px !important;
  min-width: 28px !important;
  position: relative !important;
}
.imt-img-loading {
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAtFBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////oK74hAAAAPHRSTlMABBMIDyQXHwyBfFdDMSw+OjXCb+5RG51IvV/k0rOqlGRM6KKMhdvNyZBz9MaupmxpWyj437iYd/yJVNZeuUC7AAACt0lEQVRIx53T2XKiUBCA4QYOiyCbiAsuuGBcYtxiYtT3f6/pbqoYHVFO5r+iivpo6DpAWYpqeoFfr9f90DsYAuRSWkFnPO50OgR9PwiCUFcl2GEcx+N/YBh6pvKaefHlUgZd1zVe0NbYcQjGBfzrPE8Xz8aF+71D8gG6DHFPpc4a7xFiCDuhaWgKgGIJQ3d5IMGDrpS4S5KgpIm+en9f6PlAhKby4JwEIxlYJV9h5k5nee9GoxHJ2IDSNB0dwdad1NAxDJ/uXDHYmebdk4PdbkS58CIVHdYSUHTYYRWOJblWSyu2lmy3KNFVJNBhxcuGW4YBVCbYGRZwIooipHsNqjM4FbgOQqQqSKQQU9V8xmi1QlgHqQQ6DDBvRUVCDirs+EzGDGOQTCATgtYTnbCVLgsVgRE0T1QE0qHCFAht2z6dLvJQs3Lo2FQoDxWNUiBhaP4eRgwNkI+dAjVOA/kUrIDwf3CG8NfNOE0eiFotSuo+rBiq8tD9oY4Qzc6YJw99hl1wzpQvD7ef2M8QgnOGJfJw+EltQc+oX2yn907QB22WZcvlUpd143dqQu+8pCJZuGE4xCuPXJqqcs5sNpsI93Rmzym1k4Npk+oD1SH3/a3LOK/JpUBpWfqNySxWzCfNCUITuDG5dtuphrUJ1myeIE9bIsPiKrfqTai5WZxbhtNphYx6GEIHihyGFTI69lje/rxajdh0s0msZ0zYxyPLhYCb1CyHm9Qsd2H37Y3lugVwL9kNh8Ot8cha6fUNQ8nuXi5z9/ExsAO4zQrb/ev1yrCB7lGyQzgYDGuxq1toDN/JGvN+HyWNHKB7zEoK+PX11e12G431erGYzwmytAWU56fkMHY5JJnDRR2eZji3AwtIcrEV8Cojat/BdQ7XOwGV1e1hDjGGjXbdArm8uJZtCH5MbcctVX8A1WpqumJHwckAAAAASUVORK5CYII=");
  background-size: 28px 28px;
  animation: image-loading-rotate 1s linear infinite !important;
}

.imt-image-status span {
  color: var(--bg-2, #fff) !important;
  font-size: 14px !important;
  line-height: 14px !important;
  font-weight: 500 !important;
  font-family: "PingFang SC", Arial, sans-serif !important;
}

.imt-primary-button {
  display: flex;
  padding: 12px 80px;
  justify-content: center;
  align-items: center;
  gap: 8px;
  border-radius: 8px;
  background: #ea4c89;
  color: #fff;
  font-size: 16px;
  font-style: normal;
  font-weight: 700;
  line-height: 24px;
  border: none;
  cursor: pointer;
}

.imt-retry-text {
  color: #999;
  text-align: center;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 21px;
  cursor: pointer;
}

.imt-action-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.imt-modal-content-text {
  text-align: left;
  color: #333;
  font-size: 16px;
  font-weight: 400;
  line-height: 24px;
}

@keyframes image-loading-rotate {
  from {
    transform: rotate(360deg);
  }
  to {
    transform: rotate(0deg);
  }
}

.imt-linear-gradient-text {
  background: linear-gradient(90deg, #00a6ff 0%, #c369ff 52.4%, #ff4590 100%);
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.imt-flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

.imt-linear-black-btn {
  border-radius: 50px;
  background: linear-gradient(66deg, #222 19%, #696969 94.25%);
  height: 48px;
  width: 100%;
  color: #fff;
  font-size: 16px;
  font-weight: 700;
  display: flex;
  align-items: center;
  cursor: pointer;
  justify-content: center;
}
</style></head>
<body>
  <div class="kt-root">
    

    <div class="grid-2x2">
      <!-- TOP LEFT: CONTROLS -->
      <section class="card">
        <div class="card-title">Asset &amp; Timeframe Selector</div>
        <div class="card-subtitle">Pilih kelas aset, ticker, dan timeframe untuk dianalisa.</div>

        <div class="controls-grid">
          <div class="control-group">
            <label for="assetClassSelect">Asset Class</label>
            <select id="assetClassSelect">
              <option value="forex">Forex</option>
              <option value="commodities">Commodities</option>
              <option value="indices">Indices</option>
              <option value="bonds">Bonds</option>
              <option value="stocks">Stocks</option>
              <option value="crypto">Cryptocurrencies</option>
            </select>
          </div>

          <div class="control-group">
            <label for="tickerSelect">Tickers</label>
            <select id="tickerSelect">
              <!-- Contoh default, nanti bisa diisi dinamis dari backend -->
              <option value="EURUSD=X">EURUSD (Forex)</option>
              <option value="XAUUSD=X">XAUUSD (Gold)</option>
              <option value="GC=F">GC=F (Gold Futures)</option>
              <option value="ES=F">ES=F (S&amp;P 500 Futures)</option>
              <option value="^GSPC">^GSPC (S&amp;P 500 Index)</option>
              <option value="BTC-USD">BTC-USD (Bitcoin)</option>
              <option value="AAPL">AAPL (Apple)</option>
            </select>
          </div>

          <div class="control-group">
            <label for="timeframeSelect">Timeframe</label>
            <select id="timeframeSelect">
              <option value="1h">1H</option>
              <option value="4h" selected="">4H</option>
              <option value="1d">1D</option>
              <option value="1wk">1W</option>
              <option value="1mo">1M</option>
            </select>
          </div>

          <div class="control-group">
            <label>&nbsp;</label>
            <button class="btn-apply" id="applyBtn">Apply</button>
          </div>
        </div>

        <div class="controls-footer">
          <span id="selectionInfo">EURUSD=X (4H, forex)</span>
          <span id="lastUpdated">Last update: 11/15/2025, 8:06:37 PM</span>
        </div>
      </section>

      <!-- TOP RIGHT: MAIN CHART (SMA, VOLUME, MACD) -->
      <section class="card">
        <div class="card-title">Price &amp; Core Indicators</div>
        <div class="card-subtitle">
          Close price + SMA(50/100/200), Volume, MACD (12,26,9).
        </div>

        <div class="chart-wrapper">
          <canvas id="priceChart" style="display: block; box-sizing: border-box; height: 204px; width: 645.3px;" width="968" height="306"></canvas>
        </div>

        <div class="legend">
          <span>• Price (Close)</span>
          <span>• SMA 50</span>
          <span>• SMA 100</span>
          <span>• SMA 200</span>
          <span>• Volume (bar)</span>
          <span>• MACD (line &amp; histogram)</span>
        </div>

        <div class="meta-line" id="priceMeta">Sample data only. Hubungkan ke backend yfinance untuk data real-time.</div>
      </section>

      <!-- BOTTOM LEFT: MULTI-TF SUMMARY -->
      <section class="card">
        <div class="summary-header">
          <div>
            <div class="card-title">Multi-Timeframe Indicator Summary</div>
            <div class="card-subtitle">
              SMA · Stoch · RSI · CCI · OBV · ATR · MACD
            </div>
          </div>
          <div class="rating-pill" id="overallRating">Strong Sell</div>
        </div>

        <table class="summary-table" id="summaryTable">
          <thead>
            <tr>
              <th>TF</th>
              <th>SMA</th>
              <th>Stoch</th>
              <th>RSI</th>
              <th>CCI</th>
              <th>OBV</th>
              <th>ATR</th>
              <th>MACD</th>
            </tr>
          </thead>
          <tbody><tr><td>1H</td><td class="signal-sell">Sell</td><td class="signal-neutral">Neutral</td><td class="signal-neutral">Neutral</td><td class="signal-sell">Sell</td><td class="signal-sell">Sell</td><td class="signal-buy">Buy</td><td class="signal-neutral">Neutral</td></tr><tr><td>4H</td><td class="signal-sell">Sell</td><td class="signal-neutral">Neutral</td><td class="signal-sell">Sell</td><td class="signal-buy">Buy</td><td class="signal-sell">Sell</td><td class="signal-sell">Sell</td><td class="signal-sell">Sell</td></tr><tr><td>1D</td><td class="signal-neutral">Neutral</td><td class="signal-buy">Buy</td><td class="signal-sell">Sell</td><td class="signal-neutral">Neutral</td><td class="signal-buy">Buy</td><td class="signal-buy">Buy</td><td class="signal-sell">Sell</td></tr><tr><td>1W</td><td class="signal-sell">Sell</td><td class="signal-buy">Buy</td><td class="signal-sell">Sell</td><td class="signal-neutral">Neutral</td><td class="signal-buy">Buy</td><td class="signal-sell">Sell</td><td class="signal-sell">Sell</td></tr></tbody>
        </table>

        <div class="meta-line" id="summaryConclusion">Conclusion: Strong Sell (dummy calculation). Integrasikan dengan hasil indikator multi-timeframe dari backend.</div>
      </section>

      <!-- BOTTOM RIGHT: PATTERN FINDER CHART -->
      <section class="card">
        <div class="card-title">Pattern Finder</div>
        <div class="card-subtitle">
          Deteksi: Cup &amp; Handle, Double Bottom, Double Top, Falling Wedge, dan pola lainnya.
        </div>

        <div class="chart-wrapper">
          <canvas id="patternChart" style="display: block; box-sizing: border-box; height: 186px; width: 645.3px;" width="968" height="279"></canvas>
        </div>

        <div class="pattern-list" id="patternList">
          <span class="pattern-tag">Cup &amp; Handle</span>
          <span class="pattern-tag active">Double Bottom</span>
          <span class="pattern-tag">Double Top</span>
          <span class="pattern-tag">Falling Wedge</span>
          <span class="pattern-tag">Rising Wedge</span>
          <span class="pattern-tag">Head &amp; Shoulders</span>
        </div>

        <div class="meta-line" id="patternMeta">Detected patterns (dummy): gunakan engine pattern-finder di backend (Python + yfinance) dan kirim hasilnya ke iframe ini.</div>
      </section>
    </div>
  </div>

  <script>
    // =========================
    //  UTIL DUMMY DATA (DEMO)
    // =========================
    function generateDummySeries(points, base = 100, volatility = 1.0) {
      const data = [];
      let v = base;
      for (let i = 0; i < points; i++) {
        v += (Math.random() - 0.5) * volatility;
        data.push(parseFloat(v.toFixed(2)));
      }
      return data;
    }

    function simpleMovingAverage(values, period) {
      const sma = [];
      for (let i = 0; i < values.length; i++) {
        if (i < period - 1) {
          sma.push(null);
        } else {
          let sum = 0;
          for (let j = i - period + 1; j <= i; j++) {
            sum += values[j];
          }
          sma.push(sum / period);
        }
      }
      return sma;
    }

    function computeMACD(values, fast = 12, slow = 26, signal = 9) {
      function ema(period) {
        const k = 2 / (period + 1);
        const result = [];
        let prev = values[0];
        result.push(prev);
        for (let i = 1; i < values.length; i++) {
          const val = values[i] * k + prev * (1 - k);
          result.push(val);
          prev = val;
        }
        return result;
      }
      const emaFast = ema(fast);
      const emaSlow = ema(slow);
      const macdLine = emaFast.map((v, i) => v - emaSlow[i]);
      const signalLine = (function(){
        const k = 2 / (signal + 1);
        const result = [];
        let prev = macdLine[0];
        result.push(prev);
        for (let i = 1; i < macdLine.length; i++) {
          const val = macdLine[i] * k + prev * (1 - k);
          result.push(val);
          prev = val;
        }
        return result;
      })();
      const histogram = macdLine.map((v, i) => v - signalLine[i]);
      return { macdLine, signalLine, histogram };
    }

    // =========================
    //  CHART INIT
    // =========================
    let priceChart, patternChart;

    function initCharts() {
      const ctxPrice = document.getElementById('priceChart').getContext('2d');
      const ctxPattern = document.getElementById('patternChart').getContext('2d');

      // Dummy labels (misal 100 candle)
      const points = 100;
      const labels = Array.from({length: points}, (_, i) => 'C' + (i+1));

      // Dummy close price & volume
      const close = generateDummySeries(points, 100, 1.5);
      const volume = generateDummySeries(points, 5000, 500);

      // SMA
      const sma50 = simpleMovingAverage(close, 20);
      const sma100 = simpleMovingAverage(close, 50);
      const sma200 = simpleMovingAverage(close, 80);

      // MACD
      const macdObj = computeMACD(close);

      priceChart = new Chart(ctxPrice, {
        type:'bar',
        data:{
          labels:labels,
          datasets:[
            {
              type:'line',
              label:'Close',
              data:close,
              yAxisID:'y',
              borderWidth:1.2,
              pointRadius:0,
            },
            {
              type:'line',
              label:'SMA 50',
              data:sma50,
              yAxisID:'y',
              borderWidth:0.8,
              pointRadius:0,
            },
            {
              type:'line',
              label:'SMA 100',
              data:sma100,
              yAxisID:'y',
              borderWidth:0.8,
              pointRadius:0,
            },
            {
              type:'line',
              label:'SMA 200',
              data:sma200,
              yAxisID:'y',
              borderWidth:0.8,
              pointRadius:0,
            },
            {
              type:'bar',
              label:'Volume',
              data:volume,
              yAxisID:'y1',
              borderWidth:0,
            },
            {
              type:'line',
              label:'MACD',
              data:macdObj.macdLine,
              yAxisID:'y2',
              borderWidth:0.8,
              pointRadius:0,
            },
            {
              type:'bar',
              label:'MACD Hist',
              data:macdObj.histogram,
              yAxisID:'y2',
              borderWidth:0,
            },
          ]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          plugins:{
            legend:{ display:false },
          },
          scales:{
            y:{
              position:'left',
              ticks:{ font:{ size:9 } }
            },
            y1:{
              position:'right',
              grid:{ drawOnChartArea:false },
              ticks:{ font:{ size:9 } }
            },
            y2:{
              position:'right',
              grid:{ drawOnChartArea:false },
              ticks:{ display:false }
            },
            x:{
              ticks:{ display:false }
            }
          }
        }
      });

      // Pattern chart: gunakan close yang sama
      patternChart = new Chart(ctxPattern, {
        type:'line',
        data:{
          labels:labels,
          datasets:[
            {
              label:'Close',
              data:close,
              borderWidth:1,
              pointRadius:0,
            }
          ]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          plugins:{ legend:{ display:false } },
          scales:{
            y:{ ticks:{ font:{ size:9 } } },
            x:{ ticks:{ display:false } }
          }
        }
      });

      document.getElementById('priceMeta').textContent =
        'Sample data only. Hubungkan ke backend yfinance untuk data real-time.';
    }

    // =========================
    //  MULTI-TF SUMMARY
    // =========================
    function updateSummaryDummy() {
      const tfs = ['1H','4H','1D','1W'];
      const indicators = ['SMA','Stoch','RSI','CCI','OBV','ATR','MACD'];
      const tbody = document.querySelector('#summaryTable tbody');
      tbody.innerHTML = '';

      const signals = ['Buy','Sell','Neutral'];
      function randomSignal() {
        return signals[Math.floor(Math.random()*signals.length)];
      }

      tfs.forEach(tf => {
        const tr = document.createElement('tr');
        const tfTd = document.createElement('td');
        tfTd.textContent = tf;
        tr.appendChild(tfTd);

        indicators.forEach(ind => {
          const td = document.createElement('td');
          const sig = randomSignal();
          td.textContent = sig;
          if (sig === 'Buy') td.classList.add('signal-buy');
          else if (sig === 'Sell') td.classList.add('signal-sell');
          else td.classList.add('signal-neutral');
          tr.appendChild(td);
        });

        tbody.appendChild(tr);
      });

      // Hitung overall rating sederhana
      let buyCount = document.querySelectorAll('.signal-buy').length;
      let sellCount = document.querySelectorAll('.signal-sell').length;
      let ratingText = 'Neutral';
      if (buyCount >= sellCount * 2 && buyCount > 4) ratingText = 'Strong Buy';
      else if (buyCount > sellCount) ratingText = 'Buy';
      else if (sellCount >= buyCount * 2 && sellCount > 4) ratingText = 'Strong Sell';
      else if (sellCount > buyCount) ratingText = 'Sell';

      const ratingEl = document.getElementById('overallRating');
      ratingEl.textContent = ratingText;
      document.getElementById('summaryConclusion').textContent =
        'Conclusion: ' + ratingText + ' (dummy calculation). Integrasikan dengan hasil indikator multi-timeframe dari backend.';

    }

    // =========================
    //  PATTERN LIST (DUMMY)
    // =========================
    function updatePatternDummy() {
      const tags = document.querySelectorAll('#patternList .pattern-tag');
      tags.forEach(tag => tag.classList.remove('active'));
      // random aktifkan 1-2 pola
      const arr = Array.from(tags);
      if (arr.length === 0) return;
      const first = arr[Math.floor(Math.random()*arr.length)];
      first.classList.add('active');
      if (Math.random() > 0.6) {
        const second = arr[Math.floor(Math.random()*arr.length)];
        if (second !== first) second.classList.add('active');
      }
      document.getElementById('patternMeta').textContent =
        'Detected patterns (dummy): gunakan engine pattern-finder di backend (Python + yfinance) dan kirim hasilnya ke iframe ini.';
    }

    // =========================
    //  BACKEND HOOK (YFINANCE)
    // =========================
    async function fetchTaFromBackend(assetClass, ticker, timeframe) {
      // NOTE:
      // Di sisi server, kamu bisa pakai Python + yfinance untuk ambil OHLCV,
      // hitung indikator (SMA, Stoch, RSI, CCI, OBV, ATR, MACD, pattern, dll),
      // lalu expose via endpoint JSON, misalnya:
      //
      // GET /api/ta?assetClass=forex&ticker=EURUSD=X&timeframe=4h
      //
      // Contoh struktur respon (disarankan):
      // {
      //   ohlc: [{time: "...", open:..., high:..., low:..., close:..., volume:...}, ...],
      //   indicators: {
      //     sma50: [...],
      //     sma100: [...],
      //     sma200: [...],
      //     macd: { line:[...], signal:[...], hist:[...] },
      //     multi_tf_summary: {...},
      //     patterns: ["Double Bottom","Falling Wedge"]
      //   }
      // }
      //
      // Di sini aku pakai dummy supaya halaman tetap jalan out-of-the-box.
      return null;
      /*
      const url = `/api/ta?assetClass=${encodeURIComponent(assetClass)}&ticker=${encodeURIComponent(ticker)}&timeframe=${encodeURIComponent(timeframe)}`;
      const res = await fetch(url);
      if (!res.ok) throw new Error('Failed to fetch TA data');
      return await res.json();
      */
    }

    async function applySelection() {
      const assetClass = document.getElementById('assetClassSelect').value;
      const ticker = document.getElementById('tickerSelect').value;
      const timeframe = document.getElementById('timeframeSelect').value;

      document.getElementById('selectionInfo').textContent =
        `${ticker} (${timeframe.toUpperCase()}, ${assetClass})`;
      document.getElementById('lastUpdated').textContent =
        'Last update: ' + new Date().toLocaleString();

      // Saat backend sudah siap, kamu bisa pakai data real:
      // const data = await fetchTaFromBackend(assetClass, ticker, timeframe);
      // lalu update chart, summary, dan pattern berdasarkan data tsb.

      updateSummaryDummy();
      updatePatternDummy();
    }

    // =========================
    //  INIT
    // =========================
    window.addEventListener('load', () => {
      initCharts();
      updateSummaryDummy();
      updatePatternDummy();
      applySelection();

      document.getElementById('applyBtn').addEventListener('click', () => {
        applySelection();
      });
    });
  </script>


</body><chatgpt-sidebar data-gpts-theme="light"></chatgpt-sidebar><div id="immersive-translate-browser-popup" style="all: initial"></div></html>
